<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Julie Neisler">

<title>Flight EDA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="EDA_quarto_3_files/libs/clipboard/clipboard.min.js"></script>
<script src="EDA_quarto_3_files/libs/quarto-html/quarto.js"></script>
<script src="EDA_quarto_3_files/libs/quarto-html/popper.min.js"></script>
<script src="EDA_quarto_3_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="EDA_quarto_3_files/libs/quarto-html/anchor.min.js"></script>
<link href="EDA_quarto_3_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="EDA_quarto_3_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="EDA_quarto_3_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="EDA_quarto_3_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="EDA_quarto_3_files/libs/bootstrap/bootstrap-47a8538d16b3c3ea3e76eef3371a91a5.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="EDA_quarto_3_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="EDA_quarto_3_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="EDA_quarto_3_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="EDA_quarto_3_files/libs/pagedtable-1.1/js/pagedtable.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#getting-set-up" id="toc-getting-set-up" class="nav-link active" data-scroll-target="#getting-set-up">Getting Set Up</a>
  <ul class="collapse">
  <li><a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages">Packages</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  </ul></li>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning">Data Cleaning</a>
  <ul class="collapse">
  <li><a href="#removing-missing-data-and-data-with-no-variance" id="toc-removing-missing-data-and-data-with-no-variance" class="nav-link" data-scroll-target="#removing-missing-data-and-data-with-no-variance">Removing Missing Data and Data with No Variance</a></li>
  <li><a href="#updating-data-formats" id="toc-updating-data-formats" class="nav-link" data-scroll-target="#updating-data-formats">Updating Data Formats</a></li>
  <li><a href="#dates" id="toc-dates" class="nav-link" data-scroll-target="#dates">Dates</a></li>
  <li><a href="#duration" id="toc-duration" class="nav-link" data-scroll-target="#duration">Duration</a></li>
  <li><a href="#route-analysis" id="toc-route-analysis" class="nav-link" data-scroll-target="#route-analysis">Route Analysis</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#routes" id="toc-routes" class="nav-link" data-scroll-target="#routes">Routes</a></li>
  <li><a href="#price-outliers" id="toc-price-outliers" class="nav-link" data-scroll-target="#price-outliers">Price Outliers</a></li>
  <li><a href="#correlation-matrix" id="toc-correlation-matrix" class="nav-link" data-scroll-target="#correlation-matrix">Correlation Matrix</a></li>
  <li><a href="#graphing-strongest-relationships" id="toc-graphing-strongest-relationships" class="nav-link" data-scroll-target="#graphing-strongest-relationships">Graphing Strongest Relationships</a></li>
  </ul></li>
  <li><a href="#regressions-like-a-statistician" id="toc-regressions-like-a-statistician" class="nav-link" data-scroll-target="#regressions-like-a-statistician">Regressions like a statistician</a>
  <ul class="collapse">
  <li><a href="#approach-1" id="toc-approach-1" class="nav-link" data-scroll-target="#approach-1">Approach 1</a></li>
  </ul></li>
  <li><a href="#regressions-like-a-data-scientist" id="toc-regressions-like-a-data-scientist" class="nav-link" data-scroll-target="#regressions-like-a-data-scientist">Regressions like a Data Scientist</a>
  <ul class="collapse">
  <li><a href="#preparing-data-for-all-subsets-regression" id="toc-preparing-data-for-all-subsets-regression" class="nav-link" data-scroll-target="#preparing-data-for-all-subsets-regression">Preparing Data for All Subsets Regression</a></li>
  <li><a href="#variable-selection-via-standardized-regression" id="toc-variable-selection-via-standardized-regression" class="nav-link" data-scroll-target="#variable-selection-via-standardized-regression">Variable Selection via Standardized Regression</a></li>
  <li><a href="#streamlined-all-subsets-regression" id="toc-streamlined-all-subsets-regression" class="nav-link" data-scroll-target="#streamlined-all-subsets-regression">Streamlined All Subsets Regression</a></li>
  <li><a href="#final-results" id="toc-final-results" class="nav-link" data-scroll-target="#final-results">Final Results</a></li>
  <li><a href="#key-findings" id="toc-key-findings" class="nav-link" data-scroll-target="#key-findings">Key Findings</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Flight EDA</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Julie Neisler </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<style type="text/css">
.main-container {
  max-width: 1400px;
  margin-left: auto;
  margin-right: auto;
}

/* Better table formatting */
.table {
  font-size: 0.9em;
  margin: 1em 0;
}

.table th, .table td {
  padding: 0.5em;
  text-align: left;
}

/* Coefficient table styling */
.coef-table {
  font-size: 0.85em;
  font-family: monospace;
}

/* Better code output */
pre {
  font-size: 0.85em;
  white-space: pre-wrap;
  word-wrap: break-word;
}
</style>
<section id="getting-set-up" class="level1">
<h1>Getting Set Up</h1>
<section id="packages" class="level2">
<h2 class="anchored" data-anchor-id="packages">Packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Accessing and Reading Data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(googleCloudStorageR) <span class="co"># let's me pull in the data from GCP</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl) <span class="co"># read data</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Manipulation</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># Basic data manipulation function</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor) <span class="co"># Advanced data manipulation function</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Dealing with Dates</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hms) </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphing and Analysis</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot) <span class="co"># graph correlation plots</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps) <span class="co"># fancy regressions</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom) <span class="co"># fancy regressions</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Quarto</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(flight_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 10,683
Columns: 11
$ Airline         &lt;chr&gt; "IndiGo", "Air India", "Jet Airways", "IndiGo", "IndiG…
$ Date_of_Journey &lt;chr&gt; "24/03/2019", "1/05/2019", "9/06/2019", "12/05/2019", …
$ Source          &lt;chr&gt; "Banglore", "Kolkata", "Delhi", "Kolkata", "Banglore",…
$ Destination     &lt;chr&gt; "New Delhi", "Banglore", "Cochin", "Banglore", "New De…
$ Route           &lt;chr&gt; "BLR → DEL", "CCU → IXR → BBI → BLR", "DEL → LKO → BOM…
$ Dep_Time        &lt;chr&gt; "22:20", "05:50", "09:25", "18:05", "16:50", "09:00", …
$ Arrival_Time    &lt;chr&gt; "01:10 22 Mar", "13:15", "04:25 10 Jun", "23:30", "21:…
$ Duration        &lt;chr&gt; "2h 50m", "7h 25m", "19h", "5h 25m", "4h 45m", "2h 25m…
$ Total_Stops     &lt;chr&gt; "non-stop", "2 stops", "2 stops", "1 stop", "1 stop", …
$ Additional_Info &lt;chr&gt; "No info", "No info", "No info", "No info", "No info",…
$ Price           &lt;dbl&gt; 3897, 7662, 13882, 6218, 13302, 3873, 11087, 22270, 11…</code></pre>
</div>
</div>
</section>
</section>
<section id="data-cleaning" class="level1">
<h1>Data Cleaning</h1>
<section id="removing-missing-data-and-data-with-no-variance" class="level2">
<h2 class="anchored" data-anchor-id="removing-missing-data-and-data-with-no-variance">Removing Missing Data and Data with No Variance</h2>
<p><strong>Amount of Missingness by Variable</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>flight_data <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="sc">~</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Missing Values by Variable"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Missing Values by Variable</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Airline</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Date_of_Journey</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Source</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Destination</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Route</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Dep_Time</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Arrival_Time</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Duration</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Total_Stops</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Additional_Info</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong><br>
Only one flight has 4 stops</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>flight_data <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Total_Stops <span class="sc">==</span> <span class="st">"4 stops"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Flight with 4 stops"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"100%"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Flight with 4 stops</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Airline</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Date_of_Journey</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Source</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Destination</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Route</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Dep_Time</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Arrival_Time</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Duration</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Total_Stops</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Additional_Info</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Air India</td>
<td style="text-align: left;">01/03/2019</td>
<td style="text-align: left;">Banglore</td>
<td style="text-align: left;">New Delhi</td>
<td style="text-align: left;">BLR → CCU → BBI → HYD → VGA → DEL</td>
<td style="text-align: left;">05:50</td>
<td style="text-align: left;">11:20 02 Mar</td>
<td style="text-align: left;">29h 30m</td>
<td style="text-align: left;">4 stops</td>
<td style="text-align: left;">Change airports</td>
<td style="text-align: right;">17686</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<p><strong><br>
Check for missing Total_Stops</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>flight_data <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(Total_Stops)) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Flights with missing Total_Stops"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Flights with missing Total_Stops</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Airline</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Date_of_Journey</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Source</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Destination</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Route</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Dep_Time</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Arrival_Time</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Duration</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Total_Stops</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Additional_Info</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Air India</td>
<td style="text-align: left;">6/05/2019</td>
<td style="text-align: left;">Delhi</td>
<td style="text-align: left;">Cochin</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">09:45</td>
<td style="text-align: left;">09:25 07 May</td>
<td style="text-align: left;">23h 40m</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">No info</td>
<td style="text-align: right;">7480</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><br>
The row with 4 stops is an outlier, and the row with missing data can’t be extrapolated. <strong>Removing both.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>flight_data <span class="ot">&lt;-</span> flight_data <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Total_Stops <span class="sc">!=</span> <span class="st">"4 stops"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="updating-data-formats" class="level2">
<h2 class="anchored" data-anchor-id="updating-data-formats">Updating Data Formats</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>flight_data<span class="sc">$</span>Airline <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(flight_data<span class="sc">$</span>Airline)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>flight_data<span class="sc">$</span>Total_Stops <span class="ot">&lt;-</span> <span class="fu">factor</span>(flight_data<span class="sc">$</span>Total_Stops, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"non-stop"</span>, <span class="st">"1 stop"</span>, <span class="st">"2 stops"</span>, <span class="st">"3 stops"</span>, <span class="st">"4 stops"</span>))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>flight_data<span class="sc">$</span>Additional_Info <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(flight_data<span class="sc">$</span>Additional_Info)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dates" class="level2">
<h2 class="anchored" data-anchor-id="dates">Dates</h2>
<p>Arrival time is date and time but departure time is just the time, so let’s get that fixed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>flight_data1 <span class="ot">&lt;-</span> flight_data <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">departure_date_time =</span> <span class="fu">dmy_hms</span>(<span class="fu">paste0</span>(Date_of_Journey, <span class="st">" "</span>, Dep_Time, <span class="st">":00"</span>))) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There is only a date for arrival if it was different than the departure date. Let’s get that fixed so that both departure and arrival have a full date and time set up.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>flight_data2 <span class="ot">&lt;-</span> flight_data1 <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Arrival_Time_Only =</span> <span class="fu">str_extract</span>(Arrival_Time, <span class="st">"^</span><span class="sc">\\</span><span class="st">d{2}:</span><span class="sc">\\</span><span class="st">d{2}"</span>), <span class="co"># Pull out just time</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">Dep_Time =</span> <span class="fu">paste0</span>(Dep_Time, <span class="st">":00"</span>),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Arrival_Time_Only =</span> <span class="fu">paste0</span>(Arrival_Time_Only, <span class="st">":00"</span>),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Arrival_Date =</span> <span class="fu">str_extract</span>(Arrival_Time, <span class="st">"</span><span class="sc">\\</span><span class="st">d{1,2} </span><span class="sc">\\</span><span class="st">w{3}$"</span>) <span class="co"># Pull out just date</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Arrival_Date, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"Arrival_Day"</span>, <span class="st">"Arrival_Month"</span>), <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Arrival_Month_Num =</span> <span class="fu">case_when</span>(Arrival_Month <span class="sc">==</span> <span class="st">"Jan"</span> <span class="sc">~</span> <span class="dv">01</span>, <span class="co"># replacing the words with numbers</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                                       Arrival_Month <span class="sc">==</span> <span class="st">"Feb"</span> <span class="sc">~</span> <span class="dv">02</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                                       Arrival_Month <span class="sc">==</span> <span class="st">"Mar"</span> <span class="sc">~</span> <span class="dv">03</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>                                       Arrival_Month <span class="sc">==</span> <span class="st">"Apr"</span> <span class="sc">~</span> <span class="dv">04</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>                                       Arrival_Month <span class="sc">==</span> <span class="st">"May"</span> <span class="sc">~</span> <span class="dv">05</span>,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>                                       Arrival_Month <span class="sc">==</span> <span class="st">"Jun"</span> <span class="sc">~</span> <span class="dv">06</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>                                       Arrival_Month <span class="sc">==</span> <span class="st">"Jul"</span> <span class="sc">~</span> <span class="dv">07</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>                                       Arrival_Month <span class="sc">==</span> <span class="st">"Aug"</span> <span class="sc">~</span> <span class="dv">08</span>,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>                                       Arrival_Month <span class="sc">==</span> <span class="st">"Sep"</span> <span class="sc">~</span> <span class="dv">09</span>,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>                                       Arrival_Month <span class="sc">==</span> <span class="st">"Oct"</span> <span class="sc">~</span> <span class="dv">10</span>,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>                                       Arrival_Month <span class="sc">==</span> <span class="st">"Nov"</span> <span class="sc">~</span> <span class="dv">11</span>,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>                                       Arrival_Month <span class="sc">==</span> <span class="st">"Dec"</span> <span class="sc">~</span> <span class="dv">12</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Date_of_Journey, <span class="co"># The dates don't have years, so pulling out the departure years as reference</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"Departure_Day"</span>, <span class="st">"Departure_Month"</span>, <span class="st">"Departure_Year"</span>), </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">sep =</span> <span class="st">"/"</span>, </span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Arrival_Day =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(Arrival_Day), Arrival_Day, <span class="fu">as.numeric</span>(Departure_Day)), </span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">Arrival_Month_Num =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(Arrival_Month_Num), Arrival_Month_Num, <span class="fu">as.numeric</span>(Departure_Month)),</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">Arrival_Date_combined =</span> <span class="fu">paste0</span>(Departure_Year, <span class="st">"-"</span>, Arrival_Month_Num, <span class="st">"-"</span>, Arrival_Day)) <span class="sc">%&gt;%</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">arrival_date_time =</span> <span class="fu">ymd_hms</span>(<span class="fu">paste0</span>(Arrival_Date_combined, <span class="st">" "</span>, Arrival_Time_Only))) <span class="sc">%&gt;%</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Arrival_Month, <span class="sc">-</span>Arrival_Time) <span class="sc">%&gt;%</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Departure_Time =</span> Dep_Time,</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">Arrival_Month =</span> Arrival_Month_Num, </span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>         <span class="at">Arrival_Time =</span> Arrival_Time_Only) <span class="sc">%&gt;%</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Airline, Date_of_Journey, </span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>         departure_date_time, Departure_Day, Departure_Month, Departure_Year, Departure_Time,</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>         arrival_date_time, Arrival_Day, Arrival_Month, Arrival_Time,</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>         Duration, </span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>         Source, Destination, Route, Total_Stops, Price, Additional_Info)</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>flight_data3 <span class="ot">&lt;-</span> flight_data2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Making sure all the dates are formatted correctly</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>flight_data3<span class="sc">$</span>Departure_Day <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(flight_data3<span class="sc">$</span>Departure_Day)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>flight_data3<span class="sc">$</span>Departure_Month <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(flight_data3<span class="sc">$</span>Departure_Month)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>flight_data3<span class="sc">$</span>Departure_Year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(flight_data3<span class="sc">$</span>Departure_Year)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>flight_data3<span class="sc">$</span>Arrival_Day <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(flight_data3<span class="sc">$</span>Arrival_Day)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>flight_data3<span class="sc">$</span>Departure_Time <span class="ot">&lt;-</span> <span class="fu">as_hms</span>(flight_data3<span class="sc">$</span>Departure_Time)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>flight_data3<span class="sc">$</span>Arrival_Time <span class="ot">&lt;-</span> <span class="fu">as_hms</span>(flight_data3<span class="sc">$</span>Arrival_Time)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>flight_data4 <span class="ot">&lt;-</span> flight_data3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Let’s add features for day of week and hour of departure</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>flight_data4<span class="sc">$</span>departure_day_of_week <span class="ot">&lt;-</span> <span class="fu">weekdays</span>(flight_data4<span class="sc">$</span>departure_date_time)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>flight_data4<span class="sc">$</span>Departure_Hour <span class="ot">=</span> <span class="fu">hour</span>(flight_data4<span class="sc">$</span>Departure_Time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I don’t need to care about time zones since all the cities are in the same time zone.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(flight_data4<span class="sc">$</span>Source)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Banglore" "Kolkata"  "Delhi"    "Chennai"  "Mumbai"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(flight_data4<span class="sc">$</span>Destination)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "New Delhi" "Banglore"  "Cochin"    "Kolkata"   "Delhi"     "Hyderabad"</code></pre>
</div>
</div>
</section>
<section id="duration" class="level2">
<h2 class="anchored" data-anchor-id="duration">Duration</h2>
<p><strong>First calculating duration</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>flight_data4 <span class="ot">&lt;-</span> flight_data4 <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Duration_Hours =</span> <span class="fu">replace_na</span>(<span class="fu">as.numeric</span>(<span class="fu">str_extract</span>(Duration, <span class="st">"</span><span class="sc">\\</span><span class="st">d+(?=h)"</span>)), <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">replace_na</span>(<span class="fu">as.numeric</span>(<span class="fu">str_extract</span>(Duration, <span class="st">"</span><span class="sc">\\</span><span class="st">d+(?=m)"</span>)), <span class="dv">0</span>) <span class="sc">/</span> <span class="dv">60</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Then examining if calculated duration is the same as provided duration.</strong> There are a handful of flights that appear to be different. For some, it seems the arrival is before the departure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>duration_comparison <span class="ot">&lt;-</span> flight_data4 <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">calculated_duration =</span> arrival_date_time <span class="sc">-</span> departure_date_time,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">calculated_duration_hours =</span> <span class="fu">as.numeric</span>(calculated_duration, <span class="at">units =</span> <span class="st">"hours"</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">difference_between_calculation_file =</span> Duration_Hours <span class="sc">-</span> calculated_duration_hours,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">abs_difference_between_calculation_file =</span> <span class="fu">abs</span>(difference_between_calculation_file)) <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(difference_between_calculation_file <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(departure_date_time, arrival_date_time, calculated_duration_hours, Duration_Hours, difference_between_calculation_file) <span class="sc">%&gt;%</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>duration_comparison <span class="sc">%&gt;%</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Flights with Duration Discrepancies"</span>, </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Departure"</span>, <span class="st">"Arrival"</span>, <span class="st">"Calculated Hours"</span>, <span class="st">"File Hours"</span>, <span class="st">"Difference"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Flights with Duration Discrepancies</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Departure</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Arrival</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Calculated Hours</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">File Hours</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2019-03-24 22:20:00</td>
<td style="text-align: left;">2019-03-22 01:10:00</td>
<td style="text-align: right;">-69.16667</td>
<td style="text-align: right;">2.833333</td>
<td style="text-align: right;">72</td>
</tr>
<tr class="even">
<td style="text-align: left;">2019-03-21 22:00:00</td>
<td style="text-align: left;">2019-03-19 13:20:00</td>
<td style="text-align: right;">-56.66667</td>
<td style="text-align: right;">15.333333</td>
<td style="text-align: right;">72</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2019-03-18 14:05:00</td>
<td style="text-align: left;">2019-03-16 05:05:00</td>
<td style="text-align: right;">-57.00000</td>
<td style="text-align: right;">15.000000</td>
<td style="text-align: right;">72</td>
</tr>
<tr class="even">
<td style="text-align: left;">2019-03-18 16:55:00</td>
<td style="text-align: left;">2019-03-16 09:00:00</td>
<td style="text-align: right;">-55.91667</td>
<td style="text-align: right;">16.083333</td>
<td style="text-align: right;">72</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2019-03-21 22:00:00</td>
<td style="text-align: left;">2019-03-19 10:50:00</td>
<td style="text-align: right;">-59.16667</td>
<td style="text-align: right;">12.833333</td>
<td style="text-align: right;">72</td>
</tr>
<tr class="even">
<td style="text-align: left;">2019-03-15 22:55:00</td>
<td style="text-align: left;">2019-03-13 05:05:00</td>
<td style="text-align: right;">-65.83333</td>
<td style="text-align: right;">6.166667</td>
<td style="text-align: right;">72</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2019-03-21 11:50:00</td>
<td style="text-align: left;">2019-03-19 08:55:00</td>
<td style="text-align: right;">-50.91667</td>
<td style="text-align: right;">21.083333</td>
<td style="text-align: right;">72</td>
</tr>
<tr class="even">
<td style="text-align: left;">2019-03-18 07:00:00</td>
<td style="text-align: left;">2019-03-16 07:40:00</td>
<td style="text-align: right;">-47.33333</td>
<td style="text-align: right;">24.666667</td>
<td style="text-align: right;">72</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2019-03-18 11:05:00</td>
<td style="text-align: left;">2019-03-16 22:10:00</td>
<td style="text-align: right;">-36.91667</td>
<td style="text-align: right;">35.083333</td>
<td style="text-align: right;">72</td>
</tr>
<tr class="even">
<td style="text-align: left;">2019-03-21 19:35:00</td>
<td style="text-align: left;">2019-03-19 00:35:00</td>
<td style="text-align: right;">-67.00000</td>
<td style="text-align: right;">5.000000</td>
<td style="text-align: right;">72</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong><br>
No time-based patterns to wonky durations.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>flight_data4 <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">calculated_duration =</span> arrival_date_time <span class="sc">-</span> departure_date_time,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">calculated_duration_hours =</span> <span class="fu">as.numeric</span>(calculated_duration, <span class="at">units =</span> <span class="st">"hours"</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">difference_between_calculation_file =</span> Duration_Hours <span class="sc">-</span> calculated_duration_hours,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">abs_difference_between_calculation_file =</span> <span class="fu">abs</span>(difference_between_calculation_file)) <span class="sc">%&gt;%</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(difference_between_calculation_file <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> departure_date_time)) <span class="sc">+</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Flights with Duration Discrepancies"</span>,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Departure Date/Time"</span>,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_quarto_3_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Remove data where the arrival was before the departure.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>flight_data4 <span class="ot">&lt;-</span> flight_data4 <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">wonky_times =</span> <span class="fu">case_when</span>(arrival_date_time <span class="sc">&gt;</span> departure_date_time <span class="sc">~</span> <span class="st">"keep"</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"remove"</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wonky_times <span class="sc">==</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>wonky_times) <span class="sc">%&gt;%</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="route-analysis" class="level2">
<h2 class="anchored" data-anchor-id="route-analysis">Route Analysis</h2>
<p><strong>Let’s look at route structure</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>route_sample <span class="ot">&lt;-</span> <span class="fu">unique</span>(flight_data4<span class="sc">$</span>Route)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>route_sample <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Sample Routes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Sample Routes</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CCU → IXR → BBI → BLR</td>
</tr>
<tr class="even">
<td style="text-align: left;">DEL → LKO → BOM → COK</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CCU → NAG → BLR</td>
</tr>
<tr class="even">
<td style="text-align: left;">BLR → NAG → DEL</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CCU → BLR</td>
</tr>
<tr class="even">
<td style="text-align: left;">BLR → BOM → DEL</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DEL → BOM → COK</td>
</tr>
<tr class="even">
<td style="text-align: left;">DEL → BLR → COK</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MAA → CCU</td>
</tr>
<tr class="even">
<td style="text-align: left;">CCU → BOM → BLR</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong>Parsing route into individual airport codes</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>flight_data5 <span class="ot">&lt;-</span> flight_data4 <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> Route, </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">delim =</span> <span class="st">" → "</span>, </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"airport_code_departure"</span>, <span class="st">"airport_code_first_stop"</span>, </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">"airport_code_second_stop"</span>, <span class="st">"airport_code_third_stop"</span>, <span class="st">"airport_code_arrival"</span>),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">too_few =</span> <span class="st">"align_start"</span>,  <span class="co"># Fill missing values with NA on the right</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">too_many =</span> <span class="st">"drop"</span>,        <span class="co"># Drop extra stops beyond 5 airports</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols_remove =</span> <span class="cn">FALSE</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Count the actual number of airports in each route</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">num_airports =</span> <span class="fu">str_count</span>(Route, <span class="st">" → "</span>) <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fix the column assignments based on actual number of airports</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fix arrival column - always the last airport</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">airport_code_arrival =</span> <span class="fu">case_when</span>(</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>      num_airports <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> airport_code_first_stop,   <span class="co"># 2 airports: departure → arrival</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>      num_airports <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> airport_code_second_stop,  <span class="co"># 3 airports: departure → stop → arrival  </span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>      num_airports <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> airport_code_third_stop,   <span class="co"># 4 airports: departure → stop → stop → arrival</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> airport_code_arrival                    <span class="co"># 5 airports: departure → stop → stop → stop → arrival</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fix third stop column</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">airport_code_third_stop =</span> <span class="fu">case_when</span>(</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>      num_airports <span class="sc">&lt;=</span> <span class="dv">4</span> <span class="sc">~</span> <span class="cn">NA_character_</span>,             <span class="co"># No third stop for routes with 4 or fewer airports</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> airport_code_third_stop                 <span class="co"># Keep third stop only for 5-airport routes</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fix second stop column  </span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">airport_code_second_stop =</span> <span class="fu">case_when</span>(</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>      num_airports <span class="sc">&lt;=</span> <span class="dv">3</span> <span class="sc">~</span> <span class="cn">NA_character_</span>,             <span class="co"># No second stop for routes with 3 or fewer airports</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> airport_code_second_stop                <span class="co"># Keep second stop for 4+ airport routes</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fix first stop column</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">airport_code_first_stop =</span> <span class="fu">case_when</span>(</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>      num_airports <span class="sc">&lt;=</span> <span class="dv">2</span> <span class="sc">~</span> <span class="cn">NA_character_</span>,             <span class="co"># No first stop for non-stop flights</span></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> airport_code_first_stop                 <span class="co"># Keep first stop for 3+ airport routes</span></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>num_airports)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong><br>
Verify the route parsing results</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>route_verification <span class="ot">&lt;-</span> flight_data5 <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Route, airport_code_departure, airport_code_first_stop, </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>         airport_code_second_stop, airport_code_third_stop, airport_code_arrival) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Show examples of different route types</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">which</span>(<span class="fu">str_count</span>(flight_data5<span class="sc">$</span>Route, <span class="st">" → "</span>) <span class="sc">==</span> <span class="dv">1</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],  <span class="co"># 2 airports</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">which</span>(<span class="fu">str_count</span>(flight_data5<span class="sc">$</span>Route, <span class="st">" → "</span>) <span class="sc">==</span> <span class="dv">2</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],  <span class="co"># 3 airports  </span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">which</span>(<span class="fu">str_count</span>(flight_data5<span class="sc">$</span>Route, <span class="st">" → "</span>) <span class="sc">==</span> <span class="dv">3</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],  <span class="co"># 4 airports</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">which</span>(<span class="fu">str_count</span>(flight_data5<span class="sc">$</span>Route, <span class="st">" → "</span>) <span class="sc">==</span> <span class="dv">4</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]   <span class="co"># 5 airports (if any)</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">str_count</span>(Route, <span class="st">" → "</span>))</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>route_verification <span class="sc">%&gt;%</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Route Parsing Verification"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"300px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Route Parsing Verification</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Route</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">airport_code_departure</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">airport_code_first_stop</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">airport_code_second_stop</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">airport_code_third_stop</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">airport_code_arrival</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CCU → BLR</td>
<td style="text-align: left;">CCU</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">BLR</td>
</tr>
<tr class="even">
<td style="text-align: left;">CCU → BLR</td>
<td style="text-align: left;">CCU</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">BLR</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CCU → BLR</td>
<td style="text-align: left;">CCU</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">BLR</td>
</tr>
<tr class="even">
<td style="text-align: left;">CCU → NAG → BLR</td>
<td style="text-align: left;">CCU</td>
<td style="text-align: left;">NAG</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">BLR</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BLR → NAG → DEL</td>
<td style="text-align: left;">BLR</td>
<td style="text-align: left;">NAG</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">DEL</td>
</tr>
<tr class="even">
<td style="text-align: left;">CCU → NAG → BLR</td>
<td style="text-align: left;">CCU</td>
<td style="text-align: left;">NAG</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">BLR</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BLR → NAG → DEL</td>
<td style="text-align: left;">BLR</td>
<td style="text-align: left;">NAG</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">DEL</td>
</tr>
<tr class="even">
<td style="text-align: left;">CCU → IXR → BBI → BLR</td>
<td style="text-align: left;">CCU</td>
<td style="text-align: left;">IXR</td>
<td style="text-align: left;">BBI</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">BLR</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DEL → LKO → BOM → COK</td>
<td style="text-align: left;">DEL</td>
<td style="text-align: left;">LKO</td>
<td style="text-align: left;">BOM</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">COK</td>
</tr>
<tr class="even">
<td style="text-align: left;">CCU → IXR → BBI → BLR</td>
<td style="text-align: left;">CCU</td>
<td style="text-align: left;">IXR</td>
<td style="text-align: left;">BBI</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">BLR</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DEL → LKO → BOM → COK</td>
<td style="text-align: left;">DEL</td>
<td style="text-align: left;">LKO</td>
<td style="text-align: left;">BOM</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">COK</td>
</tr>
<tr class="even">
<td style="text-align: left;">DEL → RPR → NAG → BOM → COK</td>
<td style="text-align: left;">DEL</td>
<td style="text-align: left;">RPR</td>
<td style="text-align: left;">NAG</td>
<td style="text-align: left;">BOM</td>
<td style="text-align: left;">COK</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CCU → BBI → IXR → DEL → BLR</td>
<td style="text-align: left;">CCU</td>
<td style="text-align: left;">BBI</td>
<td style="text-align: left;">IXR</td>
<td style="text-align: left;">DEL</td>
<td style="text-align: left;">BLR</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<p><strong><br>
Checking unique airports by category</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Source cities:"</span>, <span class="fu">paste</span>(<span class="fu">unique</span>(flight_data5<span class="sc">$</span>Source), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Source cities: Kolkata, Delhi, Banglore, Chennai, Mumbai </code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Destination cities:"</span>, <span class="fu">paste</span>(<span class="fu">unique</span>(flight_data5<span class="sc">$</span>Destination), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Destination cities: Banglore, Cochin, New Delhi, Kolkata, Delhi, Hyderabad </code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"First stop airports:"</span>, <span class="fu">paste</span>(<span class="fu">unique</span>(flight_data5<span class="sc">$</span>airport_code_first_stop), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>First stop airports: IXR, LKO, NAG, NA, BOM, BLR, AMD, PNQ, CCU, IDR, GAU, MAA, HYD, DEL, BHO, JAI, ATQ, JDH, BBI, GOI, BDQ, TRV, IXU, IXB, UDR, RPR, DED, VGA, COK, VNS, IXC, PAT, JLR, KNU, GWL, VTZ, NDC, IXZ, HBX, IXA, STV </code></pre>
</div>
</div>
<p><strong>Checking if City and airport code match up perfectly</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check departure alignment</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>departure_check <span class="ot">&lt;-</span> flight_data5 <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Source, airport_code_departure) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>departure_check <span class="sc">%&gt;%</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Source City vs Departure Airport Alignment"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Source City vs Departure Airport Alignment</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Source</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">airport_code_departure</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Banglore</td>
<td style="text-align: left;">BLR</td>
<td style="text-align: right;">2109</td>
</tr>
<tr class="even">
<td style="text-align: left;">Chennai</td>
<td style="text-align: left;">MAA</td>
<td style="text-align: right;">380</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Delhi</td>
<td style="text-align: left;">DEL</td>
<td style="text-align: right;">4536</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kolkata</td>
<td style="text-align: left;">CCU</td>
<td style="text-align: right;">2871</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mumbai</td>
<td style="text-align: left;">BOM</td>
<td style="text-align: right;">693</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><br>
But I’m also realizing that the Destination has New Delhi instead of Delhi, so need to change that first.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>flight_data5 <span class="ot">&lt;-</span> flight_data5 <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Destination =</span> <span class="fu">ifelse</span>(Destination <span class="sc">==</span> <span class="st">"New Delhi"</span>, <span class="st">"Delhi"</span>, Destination)) </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check arrival alignment</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>arrival_check <span class="ot">&lt;-</span> flight_data5 <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Destination, airport_code_arrival) <span class="sc">%&gt;%</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>arrival_check <span class="sc">%&gt;%</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Destination City vs Arrival Airport Alignment"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Destination City vs Arrival Airport Alignment</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Destination</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">airport_code_arrival</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Banglore</td>
<td style="text-align: left;">BLR</td>
<td style="text-align: right;">2871</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cochin</td>
<td style="text-align: left;">COK</td>
<td style="text-align: right;">4536</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Delhi</td>
<td style="text-align: left;">DEL</td>
<td style="text-align: right;">2109</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hyderabad</td>
<td style="text-align: left;">HYD</td>
<td style="text-align: right;">693</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kolkata</td>
<td style="text-align: left;">CCU</td>
<td style="text-align: right;">380</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>flight_data6 <span class="ot">&lt;-</span> flight_data5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="exploratory-data-analysis" class="level1">
<h1>Exploratory Data Analysis</h1>
<section id="routes" class="level2">
<h2 class="anchored" data-anchor-id="routes">Routes</h2>
<p><strong>Visualizing flight routes by number of stops</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>flight_data6 <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(row, Total_Stops, airport_code_departure, airport_code_first_stop, airport_code_second_stop, airport_code_third_stop, airport_code_arrival) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>row<span class="sc">:</span>Total_Stops, <span class="at">names_to =</span> <span class="st">"stop_on_trip"</span>, <span class="at">values_to =</span> <span class="st">"airport_code"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Total_Stops, stop_on_trip, airport_code) <span class="sc">%&gt;%</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stop_on_trip =</span> <span class="fu">factor</span>(stop_on_trip, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"airport_code_departure"</span>, </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">"airport_code_first_stop"</span>, </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">"airport_code_second_stop"</span>, </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">"airport_code_third_stop"</span>,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">"airport_code_arrival"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(airport_code)) <span class="sc">%&gt;%</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> stop_on_trip,  <span class="at">y =</span> <span class="fu">reorder</span>(airport_code,count), <span class="at">group =</span> row)) <span class="sc">+</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> count), <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Flight Routes by Number of Stops"</span>,</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Stop on Trip"</span>, </span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Airport Code"</span>, </span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Count of Flights</span><span class="sc">\n</span><span class="st">on that Path"</span>) <span class="sc">+</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>Total_Stops, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">vjust =</span> .<span class="dv">8</span>, <span class="at">hjust =</span> .<span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_quarto_3_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="price-outliers" class="level2">
<h2 class="anchored" data-anchor-id="price-outliers">Price Outliers</h2>
<p><strong>Number of Price Outliers</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(rstatix<span class="sc">::</span><span class="fu">identify_outliers</span>(<span class="at">data =</span> flight_data6, <span class="at">variable =</span> <span class="st">"Price"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 90</code></pre>
</div>
</div>
<p><strong>Visualizations of outliers</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>flight_data6 <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Price)) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Flight Prices"</span>,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Price"</span>) <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_quarto_3_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>An outlier is a value 1.5 times that of the IQR. Below, we see outliers are prices above $23,170.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>outlier_summary <span class="ot">&lt;-</span> rstatix<span class="sc">::</span><span class="fu">identify_outliers</span>(<span class="at">data =</span> flight_data6, <span class="at">variable =</span> <span class="st">"Price"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a more readable summary table</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>outlier_summary <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Airline, Date_of_Journey, departure_date_time, Price, is.outlier, is.extreme) <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Sample of Price Outliers"</span>,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Airline"</span>, <span class="st">"Journey Date"</span>, <span class="st">"Departure Time"</span>, <span class="st">"Price"</span>, <span class="st">"Outlier"</span>, <span class="st">"Extreme"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Sample of Price Outliers</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Airline</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Journey Date</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Departure Time</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Price</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Outlier</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Extreme</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Air India</td>
<td style="text-align: left;">1/03/2019</td>
<td style="text-align: left;">2019-03-01 23:00:00</td>
<td style="text-align: right;">27430</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">Multiple carriers</td>
<td style="text-align: left;">1/03/2019</td>
<td style="text-align: left;">2019-03-01 12:50:00</td>
<td style="text-align: right;">36983</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Jet Airways</td>
<td style="text-align: left;">01/03/2019</td>
<td style="text-align: left;">2019-03-01 08:55:00</td>
<td style="text-align: right;">26890</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jet Airways</td>
<td style="text-align: left;">01/03/2019</td>
<td style="text-align: left;">2019-03-01 07:00:00</td>
<td style="text-align: right;">26890</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Air India</td>
<td style="text-align: left;">6/03/2019</td>
<td style="text-align: left;">2019-03-06 09:40:00</td>
<td style="text-align: right;">25139</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jet Airways Business</td>
<td style="text-align: left;">01/03/2019</td>
<td style="text-align: left;">2019-03-01 05:45:00</td>
<td style="text-align: right;">52229</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Air India</td>
<td style="text-align: left;">01/03/2019</td>
<td style="text-align: left;">2019-03-01 08:50:00</td>
<td style="text-align: right;">26743</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jet Airways</td>
<td style="text-align: left;">01/03/2019</td>
<td style="text-align: left;">2019-03-01 05:45:00</td>
<td style="text-align: right;">26890</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Jet Airways</td>
<td style="text-align: left;">01/03/2019</td>
<td style="text-align: left;">2019-03-01 22:50:00</td>
<td style="text-align: right;">25735</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jet Airways</td>
<td style="text-align: left;">01/03/2019</td>
<td style="text-align: left;">2019-03-01 05:45:00</td>
<td style="text-align: right;">27992</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong>Removing the outliers.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>flight_data7 <span class="ot">&lt;-</span> flight_data6 <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Price <span class="sc">&lt;</span> <span class="dv">23170</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="correlation-matrix" class="level2">
<h2 class="anchored" data-anchor-id="correlation-matrix">Correlation Matrix</h2>
<p><strong>Including the variables in my correlation Matrix</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>corr.data <span class="ot">&lt;-</span> flight_data7 <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weekend =</span> <span class="fu">case_when</span>(departure_day_of_week <span class="sc">==</span> <span class="st">"Sunday"</span> <span class="sc">|</span> departure_day_of_week <span class="sc">==</span> <span class="st">"Saturday"</span> <span class="sc">~</span> <span class="st">"Weekend"</span>,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                             <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Weekday"</span>),</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">number_of_stops =</span> <span class="fu">case_when</span>(Total_Stops <span class="sc">==</span> <span class="st">"non-stop"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                                     Total_Stops <span class="sc">==</span> <span class="st">"1 stop"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>                                     Total_Stops <span class="sc">==</span> <span class="st">"2 stops"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>                                     Total_Stops <span class="sc">==</span> <span class="st">"3 stops"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>                                     Total_Stops <span class="sc">==</span> <span class="st">"4 stops"</span> <span class="sc">~</span> <span class="dv">4</span>),</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">premium_economy =</span> <span class="fu">str_detect</span>(Airline, <span class="st">"Premium"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Airline, premium_economy, departure_date_time, Departure_Day, Departure_Month, Departure_Time,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>         departure_day_of_week, arrival_date_time, Arrival_Day, Arrival_Month, Arrival_Time,</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>         weekend, Route, number_of_stops, airport_code_departure, airport_code_first_stop, </span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>         airport_code_second_stop, airport_code_third_stop, airport_code_arrival,</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>         Duration_Hours, Price) <span class="sc">%&gt;%</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.matrix</span>()</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(corr.data, <span class="at">use=</span><span class="st">"pairwise.complete.obs"</span>, <span class="at">method=</span><span class="st">"pearson"</span>), <span class="dv">2</span>)</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(corr_matrix, <span class="at">method=</span><span class="st">"circle"</span>, <span class="at">type=</span><span class="st">"lower"</span>, <span class="at">tl.col =</span> <span class="st">"black"</span>, <span class="at">tl.cex =</span> .<span class="dv">65</span>,</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.srt =</span> <span class="dv">45</span>, <span class="at">title =</span> <span class="st">"Correlation Matrix of Flight Variables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_quarto_3_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p><strong>Let’s look at just the Price relationships.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>corr_matrix_df <span class="ot">&lt;-</span> rstatix<span class="sc">::</span><span class="fu">cor_gather</span>(corr_matrix)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>price_correlations <span class="ot">&lt;-</span> corr_matrix_df <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(var1 <span class="sc">==</span> <span class="st">'Price'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(cor))) <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cor =</span> <span class="fu">round</span>(cor, <span class="dv">3</span>))</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>price_correlations <span class="sc">%&gt;%</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Price Correlations with Other Variables"</span>,</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Variable 1"</span>, <span class="st">"Variable 2"</span>, <span class="st">"Correlation"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"400px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Price Correlations with Other Variables</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Variable 1</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Variable 2</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Correlation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Price</td>
<td style="text-align: left;">Price</td>
<td style="text-align: right;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Price</td>
<td style="text-align: left;">number_of_stops</td>
<td style="text-align: right;">0.67</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Price</td>
<td style="text-align: left;">Duration_Hours</td>
<td style="text-align: right;">0.58</td>
</tr>
<tr class="even">
<td style="text-align: left;">Price</td>
<td style="text-align: left;">airport_code_departure</td>
<td style="text-align: right;">0.27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Price</td>
<td style="text-align: left;">Route</td>
<td style="text-align: right;">0.26</td>
</tr>
<tr class="even">
<td style="text-align: left;">Price</td>
<td style="text-align: left;">airport_code_second_stop</td>
<td style="text-align: right;">-0.22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Price</td>
<td style="text-align: left;">airport_code_arrival</td>
<td style="text-align: right;">-0.17</td>
</tr>
<tr class="even">
<td style="text-align: left;">Price</td>
<td style="text-align: left;">airport_code_first_stop</td>
<td style="text-align: right;">-0.14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Price</td>
<td style="text-align: left;">Departure_Day</td>
<td style="text-align: right;">-0.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">Price</td>
<td style="text-align: left;">Arrival_Day</td>
<td style="text-align: right;">-0.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Price</td>
<td style="text-align: left;">departure_date_time</td>
<td style="text-align: right;">-0.08</td>
</tr>
<tr class="even">
<td style="text-align: left;">Price</td>
<td style="text-align: left;">departure_day_of_week</td>
<td style="text-align: right;">0.08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Price</td>
<td style="text-align: left;">arrival_date_time</td>
<td style="text-align: right;">-0.07</td>
</tr>
<tr class="even">
<td style="text-align: left;">Price</td>
<td style="text-align: left;">Departure_Month</td>
<td style="text-align: right;">-0.05</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Price</td>
<td style="text-align: left;">Arrival_Month</td>
<td style="text-align: right;">-0.05</td>
</tr>
<tr class="even">
<td style="text-align: left;">Price</td>
<td style="text-align: left;">weekend</td>
<td style="text-align: right;">0.05</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Price</td>
<td style="text-align: left;">Airline</td>
<td style="text-align: right;">-0.04</td>
</tr>
<tr class="even">
<td style="text-align: left;">Price</td>
<td style="text-align: left;">Arrival_Time</td>
<td style="text-align: right;">0.04</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Price</td>
<td style="text-align: left;">premium_economy</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">Price</td>
<td style="text-align: left;">airport_code_third_stop</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Price</td>
<td style="text-align: left;">Departure_Time</td>
<td style="text-align: right;">0.00</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<p>Number of stops and duration are easy enough to figure out. Route and second airport code and destination are all pretty high up there. There’s something about these variables that has some influence but I’m not sure what.</p>
</section>
<section id="graphing-strongest-relationships" class="level2">
<h2 class="anchored" data-anchor-id="graphing-strongest-relationships">Graphing Strongest Relationships</h2>
<p><strong>Price by total stops</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>flight_data7 <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Total_Stops)) <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">number_of_stops =</span> <span class="fu">case_when</span>(Total_Stops <span class="sc">==</span> <span class="st">"non-stop"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                                     Total_Stops <span class="sc">==</span> <span class="st">"1 stop"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                                     Total_Stops <span class="sc">==</span> <span class="st">"2 stops"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>                                     Total_Stops <span class="sc">==</span> <span class="st">"3 stops"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>                                     Total_Stops <span class="sc">==</span> <span class="st">"4 stops"</span> <span class="sc">~</span> <span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> number_of_stops, <span class="at">y =</span> Price)) <span class="sc">+</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">'jitter'</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Flight Price by Number of Stops"</span>,</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of Stops"</span>,</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Price ($)"</span>) <span class="sc">+</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Non-stop"</span>, <span class="st">"1 stop"</span>, <span class="st">"2 stops"</span>, <span class="st">"3 stops"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_quarto_3_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p><strong>Duration of flight</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>flight_data7 <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Duration_Hours)) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Duration_Hours, <span class="at">y =</span> Price)) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Flight Price by Duration"</span>,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Duration (Hours)"</span>,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Price ($)"</span>) <span class="sc">+</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_quarto_3_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p><strong>Both number of stops and duration</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>flight_data7 <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Duration_Hours)) <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Total_Stops)) <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Duration_Hours, <span class="at">y =</span> Price, <span class="at">color =</span> Total_Stops)) <span class="sc">+</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Flight Price by Duration and Number of Stops"</span>,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Duration (Hours)"</span>,</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Price ($)"</span>,</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Total Stops"</span>) <span class="sc">+</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_quarto_3_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p><strong>Route Analysis</strong></p>
<p>Well there is a clear impact of route, but not necessarily correlated with number of stops.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>flight_data7 <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Route)) <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Route, Price), <span class="at">y =</span> Price, <span class="at">fill =</span> Total_Stops)) <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Flight Price by Route"</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Route"</span>,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Price ($)"</span>,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Total Stops"</span>) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_quarto_3_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p><strong>Bringing multiple variables together</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>flight_data7 <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Duration_Hours, <span class="at">y =</span> Price)) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(Destination),</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">cols =</span> <span class="fu">vars</span>(Total_Stops)) <span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Flight Price by Duration, Stops, and Destination"</span>,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Duration (Hours)"</span>,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Price ($)"</span>) <span class="sc">+</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_quarto_3_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="regressions-like-a-statistician" class="level1">
<h1>Regressions like a statistician</h1>
<section id="approach-1" class="level2">
<h2 class="anchored" data-anchor-id="approach-1">Approach 1</h2>
<p>As a statistician, I would pick the variables that have the strongest relationships with the outcome, don’t have too much multicollinearity, and a theoretical reason to influence Price.</p>
<p>From below, we can see that the number of stops significantly predicts Price when controlling for other variables, as does duration, departure airport, and route.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>regression.flight <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Total_Stops <span class="sc">+</span> Duration_Hours <span class="sc">+</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>                          airport_code_departure <span class="sc">+</span> Route, <span class="at">data =</span> flight_data7)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a tidy summary</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>regression_summary <span class="ot">&lt;-</span> <span class="fu">tidy</span>(regression.flight) <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">4</span>)))</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>regression_summary <span class="sc">%&gt;%</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Statistician's Regression Model Results"</span>,</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Term"</span>, <span class="st">"Estimate"</span>, <span class="st">"Std Error"</span>, <span class="st">"t-statistic"</span>, <span class="st">"p-value"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"400px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Statistician's Regression Model Results</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Term</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Estimate</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Std Error</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">t-statistic</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">9701.6109</td>
<td style="text-align: right;">869.0608</td>
<td style="text-align: right;">11.1633</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Total_Stops1 stop</td>
<td style="text-align: right;">1139.4231</td>
<td style="text-align: right;">649.9356</td>
<td style="text-align: right;">1.7531</td>
<td style="text-align: right;">0.0796</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total_Stops2 stops</td>
<td style="text-align: right;">7121.5517</td>
<td style="text-align: right;">617.9348</td>
<td style="text-align: right;">11.5248</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Total_Stops3 stops</td>
<td style="text-align: right;">3959.2440</td>
<td style="text-align: right;">644.0748</td>
<td style="text-align: right;">6.1472</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Duration_Hours</td>
<td style="text-align: right;">19.1752</td>
<td style="text-align: right;">4.8461</td>
<td style="text-align: right;">3.9568</td>
<td style="text-align: right;">0.0001</td>
</tr>
<tr class="even">
<td style="text-align: left;">airport_code_departureBOM</td>
<td style="text-align: right;">5674.6212</td>
<td style="text-align: right;">2686.5043</td>
<td style="text-align: right;">2.1123</td>
<td style="text-align: right;">0.0347</td>
</tr>
<tr class="odd">
<td style="text-align: left;">airport_code_departureCCU</td>
<td style="text-align: right;">-4647.0958</td>
<td style="text-align: right;">2548.0820</td>
<td style="text-align: right;">-1.8238</td>
<td style="text-align: right;">0.0682</td>
</tr>
<tr class="even">
<td style="text-align: left;">airport_code_departureDEL</td>
<td style="text-align: right;">-3445.8404</td>
<td style="text-align: right;">852.8178</td>
<td style="text-align: right;">-4.0405</td>
<td style="text-align: right;">0.0001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">airport_code_departureMAA</td>
<td style="text-align: right;">-4960.3006</td>
<td style="text-align: right;">878.6765</td>
<td style="text-align: right;">-5.6452</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBLR → BBI → DEL</td>
<td style="text-align: right;">381.3064</td>
<td style="text-align: right;">1253.5718</td>
<td style="text-align: right;">0.3042</td>
<td style="text-align: right;">0.7610</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBLR → BDQ → DEL</td>
<td style="text-align: right;">-1793.5685</td>
<td style="text-align: right;">1105.2300</td>
<td style="text-align: right;">-1.6228</td>
<td style="text-align: right;">0.1047</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBLR → BOM → AMD → DEL</td>
<td style="text-align: right;">-2553.8200</td>
<td style="text-align: right;">1516.1433</td>
<td style="text-align: right;">-1.6844</td>
<td style="text-align: right;">0.0921</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBLR → BOM → BHO → DEL</td>
<td style="text-align: right;">-4658.0159</td>
<td style="text-align: right;">1515.8505</td>
<td style="text-align: right;">-3.0729</td>
<td style="text-align: right;">0.0021</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBLR → BOM → DEL</td>
<td style="text-align: right;">2349.5586</td>
<td style="text-align: right;">602.8213</td>
<td style="text-align: right;">3.8976</td>
<td style="text-align: right;">0.0001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBLR → BOM → IDR → DEL</td>
<td style="text-align: right;">-955.8349</td>
<td style="text-align: right;">1614.6382</td>
<td style="text-align: right;">-0.5920</td>
<td style="text-align: right;">0.5539</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBLR → BOM → IDR → GWL → DEL</td>
<td style="text-align: right;">-849.1121</td>
<td style="text-align: right;">2040.1473</td>
<td style="text-align: right;">-0.4162</td>
<td style="text-align: right;">0.6773</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBLR → BOM → IXC → DEL</td>
<td style="text-align: right;">-4077.8426</td>
<td style="text-align: right;">2686.9313</td>
<td style="text-align: right;">-1.5177</td>
<td style="text-align: right;">0.1291</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBLR → BOM → JDH → DEL</td>
<td style="text-align: right;">-2248.9786</td>
<td style="text-align: right;">1446.5784</td>
<td style="text-align: right;">-1.5547</td>
<td style="text-align: right;">0.1201</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBLR → BOM → NAG → DEL</td>
<td style="text-align: right;">-4525.7654</td>
<td style="text-align: right;">1446.7210</td>
<td style="text-align: right;">-3.1283</td>
<td style="text-align: right;">0.0018</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBLR → BOM → UDR → DEL</td>
<td style="text-align: right;">-3287.3787</td>
<td style="text-align: right;">2687.2230</td>
<td style="text-align: right;">-1.2233</td>
<td style="text-align: right;">0.2212</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBLR → CCU → BBI → DEL</td>
<td style="text-align: right;">-7973.6882</td>
<td style="text-align: right;">1515.7022</td>
<td style="text-align: right;">-5.2607</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBLR → CCU → BBI → HYD → DEL</td>
<td style="text-align: right;">-1497.8441</td>
<td style="text-align: right;">2040.1211</td>
<td style="text-align: right;">-0.7342</td>
<td style="text-align: right;">0.4628</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBLR → CCU → DEL</td>
<td style="text-align: right;">1134.2249</td>
<td style="text-align: right;">949.0002</td>
<td style="text-align: right;">1.1952</td>
<td style="text-align: right;">0.2320</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBLR → CCU → GAU → DEL</td>
<td style="text-align: right;">-5349.1850</td>
<td style="text-align: right;">1297.1851</td>
<td style="text-align: right;">-4.1237</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBLR → COK → DEL</td>
<td style="text-align: right;">-1410.5535</td>
<td style="text-align: right;">924.1852</td>
<td style="text-align: right;">-1.5263</td>
<td style="text-align: right;">0.1270</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBLR → DEL</td>
<td style="text-align: right;">-4221.5163</td>
<td style="text-align: right;">871.8087</td>
<td style="text-align: right;">-4.8423</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBLR → GAU → DEL</td>
<td style="text-align: right;">1984.6260</td>
<td style="text-align: right;">1848.3272</td>
<td style="text-align: right;">1.0737</td>
<td style="text-align: right;">0.2830</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBLR → GOI → DEL</td>
<td style="text-align: right;">-2238.4595</td>
<td style="text-align: right;">1105.0790</td>
<td style="text-align: right;">-2.0256</td>
<td style="text-align: right;">0.0428</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBLR → HBX → BOM → AMD → DEL</td>
<td style="text-align: right;">-3316.3598</td>
<td style="text-align: right;">2691.1500</td>
<td style="text-align: right;">-1.2323</td>
<td style="text-align: right;">0.2179</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBLR → HBX → BOM → BHO → DEL</td>
<td style="text-align: right;">315.2278</td>
<td style="text-align: right;">2691.2195</td>
<td style="text-align: right;">0.1171</td>
<td style="text-align: right;">0.9068</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBLR → HBX → BOM → NAG → DEL</td>
<td style="text-align: right;">-1735.8957</td>
<td style="text-align: right;">2690.1871</td>
<td style="text-align: right;">-0.6453</td>
<td style="text-align: right;">0.5188</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBLR → HYD → DEL</td>
<td style="text-align: right;">-4497.5952</td>
<td style="text-align: right;">716.4807</td>
<td style="text-align: right;">-6.2773</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBLR → HYD → VGA → DEL</td>
<td style="text-align: right;">-5779.7061</td>
<td style="text-align: right;">1355.3550</td>
<td style="text-align: right;">-4.2643</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBLR → IDR → DEL</td>
<td style="text-align: right;">-3325.2319</td>
<td style="text-align: right;">1254.5534</td>
<td style="text-align: right;">-2.6505</td>
<td style="text-align: right;">0.0080</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBLR → LKO → DEL</td>
<td style="text-align: right;">-3597.7831</td>
<td style="text-align: right;">1547.2066</td>
<td style="text-align: right;">-2.3253</td>
<td style="text-align: right;">0.0201</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBLR → MAA → DEL</td>
<td style="text-align: right;">-809.4858</td>
<td style="text-align: right;">766.6789</td>
<td style="text-align: right;">-1.0558</td>
<td style="text-align: right;">0.2911</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBLR → NAG → DEL</td>
<td style="text-align: right;">380.8836</td>
<td style="text-align: right;">1547.2066</td>
<td style="text-align: right;">0.2462</td>
<td style="text-align: right;">0.8056</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBLR → PNQ → DEL</td>
<td style="text-align: right;">-1949.0880</td>
<td style="text-align: right;">1371.1702</td>
<td style="text-align: right;">-1.4215</td>
<td style="text-align: right;">0.1552</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBLR → STV → DEL</td>
<td style="text-align: right;">-5173.3329</td>
<td style="text-align: right;">1849.0554</td>
<td style="text-align: right;">-2.7978</td>
<td style="text-align: right;">0.0052</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBLR → TRV → COK → DEL</td>
<td style="text-align: right;">-5511.6829</td>
<td style="text-align: right;">2035.7607</td>
<td style="text-align: right;">-2.7074</td>
<td style="text-align: right;">0.0068</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBLR → VGA → DEL</td>
<td style="text-align: right;">-1868.5479</td>
<td style="text-align: right;">1053.7934</td>
<td style="text-align: right;">-1.7732</td>
<td style="text-align: right;">0.0762</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBLR → VGA → HYD → DEL</td>
<td style="text-align: right;">-7433.7424</td>
<td style="text-align: right;">1614.2328</td>
<td style="text-align: right;">-4.6051</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBLR → VGA → VTZ → DEL</td>
<td style="text-align: right;">-1601.1831</td>
<td style="text-align: right;">2035.7837</td>
<td style="text-align: right;">-0.7865</td>
<td style="text-align: right;">0.4316</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBOM → AMD → ISK → HYD</td>
<td style="text-align: right;">-11009.7871</td>
<td style="text-align: right;">2863.9963</td>
<td style="text-align: right;">-3.8442</td>
<td style="text-align: right;">0.0001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBOM → BBI → HYD</td>
<td style="text-align: right;">-2575.8508</td>
<td style="text-align: right;">3608.8686</td>
<td style="text-align: right;">-0.7138</td>
<td style="text-align: right;">0.4754</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBOM → BDQ → DEL → HYD</td>
<td style="text-align: right;">-1654.8968</td>
<td style="text-align: right;">3506.8814</td>
<td style="text-align: right;">-0.4719</td>
<td style="text-align: right;">0.6370</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBOM → BHO → DEL → HYD</td>
<td style="text-align: right;">-9907.5890</td>
<td style="text-align: right;">2651.0803</td>
<td style="text-align: right;">-3.7372</td>
<td style="text-align: right;">0.0002</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBOM → BLR → CCU → BBI → HYD</td>
<td style="text-align: right;">-5450.9912</td>
<td style="text-align: right;">3606.3570</td>
<td style="text-align: right;">-1.5115</td>
<td style="text-align: right;">0.1307</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBOM → BLR → HYD</td>
<td style="text-align: right;">-7860.5518</td>
<td style="text-align: right;">2987.3867</td>
<td style="text-align: right;">-2.6312</td>
<td style="text-align: right;">0.0085</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBOM → CCU → HYD</td>
<td style="text-align: right;">-138.8818</td>
<td style="text-align: right;">3608.9699</td>
<td style="text-align: right;">-0.0385</td>
<td style="text-align: right;">0.9693</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBOM → COK → MAA → HYD</td>
<td style="text-align: right;">-13136.1754</td>
<td style="text-align: right;">3506.9912</td>
<td style="text-align: right;">-3.7457</td>
<td style="text-align: right;">0.0002</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBOM → DEL → HYD</td>
<td style="text-align: right;">-3460.7634</td>
<td style="text-align: right;">2657.3710</td>
<td style="text-align: right;">-1.3023</td>
<td style="text-align: right;">0.1928</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBOM → GOI → HYD</td>
<td style="text-align: right;">-8973.6757</td>
<td style="text-align: right;">3609.4924</td>
<td style="text-align: right;">-2.4861</td>
<td style="text-align: right;">0.0129</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBOM → GOI → PNQ → HYD</td>
<td style="text-align: right;">-5379.7657</td>
<td style="text-align: right;">2773.5812</td>
<td style="text-align: right;">-1.9396</td>
<td style="text-align: right;">0.0524</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBOM → HYD</td>
<td style="text-align: right;">-11467.8695</td>
<td style="text-align: right;">2555.2488</td>
<td style="text-align: right;">-4.4880</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBOM → IDR → DEL → HYD</td>
<td style="text-align: right;">-5963.3195</td>
<td style="text-align: right;">3037.0389</td>
<td style="text-align: right;">-1.9635</td>
<td style="text-align: right;">0.0496</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBOM → JAI → DEL → HYD</td>
<td style="text-align: right;">-5182.1958</td>
<td style="text-align: right;">3507.0511</td>
<td style="text-align: right;">-1.4777</td>
<td style="text-align: right;">0.1395</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBOM → JDH → DEL → HYD</td>
<td style="text-align: right;">-148.8352</td>
<td style="text-align: right;">3507.1254</td>
<td style="text-align: right;">-0.0424</td>
<td style="text-align: right;">0.9662</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBOM → JDH → JAI → DEL → HYD</td>
<td style="text-align: right;">-1609.7437</td>
<td style="text-align: right;">3605.7618</td>
<td style="text-align: right;">-0.4464</td>
<td style="text-align: right;">0.6553</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBOM → JLR → HYD</td>
<td style="text-align: right;">-3121.8510</td>
<td style="text-align: right;">3609.4035</td>
<td style="text-align: right;">-0.8649</td>
<td style="text-align: right;">0.3871</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBOM → MAA → HYD</td>
<td style="text-align: right;">-8198.5588</td>
<td style="text-align: right;">2987.5613</td>
<td style="text-align: right;">-2.7442</td>
<td style="text-align: right;">0.0061</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBOM → NDC → HYD</td>
<td style="text-align: right;">-12437.9748</td>
<td style="text-align: right;">3609.9132</td>
<td style="text-align: right;">-3.4455</td>
<td style="text-align: right;">0.0006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteBOM → RPR → VTZ → HYD</td>
<td style="text-align: right;">-12935.9590</td>
<td style="text-align: right;">3507.5272</td>
<td style="text-align: right;">-3.6881</td>
<td style="text-align: right;">0.0002</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteBOM → UDR → DEL → HYD</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteCCU → AMD → BLR</td>
<td style="text-align: right;">2043.1406</td>
<td style="text-align: right;">2589.9789</td>
<td style="text-align: right;">0.7889</td>
<td style="text-align: right;">0.4302</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteCCU → BBI → BLR</td>
<td style="text-align: right;">-266.8938</td>
<td style="text-align: right;">2504.3817</td>
<td style="text-align: right;">-0.1066</td>
<td style="text-align: right;">0.9151</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteCCU → BBI → BOM → BLR</td>
<td style="text-align: right;">-2123.0923</td>
<td style="text-align: right;">2650.5472</td>
<td style="text-align: right;">-0.8010</td>
<td style="text-align: right;">0.4231</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteCCU → BBI → HYD → BLR</td>
<td style="text-align: right;">-6814.3357</td>
<td style="text-align: right;">2750.0976</td>
<td style="text-align: right;">-2.4779</td>
<td style="text-align: right;">0.0132</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteCCU → BBI → IXR → DEL → BLR</td>
<td style="text-align: right;">2916.3136</td>
<td style="text-align: right;">3158.5506</td>
<td style="text-align: right;">0.9233</td>
<td style="text-align: right;">0.3559</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteCCU → BLR</td>
<td style="text-align: right;">-585.1953</td>
<td style="text-align: right;">2564.6079</td>
<td style="text-align: right;">-0.2282</td>
<td style="text-align: right;">0.8195</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteCCU → BOM → AMD → BLR</td>
<td style="text-align: right;">1864.8727</td>
<td style="text-align: right;">2749.8279</td>
<td style="text-align: right;">0.6782</td>
<td style="text-align: right;">0.4977</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteCCU → BOM → BLR</td>
<td style="text-align: right;">5001.8441</td>
<td style="text-align: right;">2481.4049</td>
<td style="text-align: right;">2.0157</td>
<td style="text-align: right;">0.0439</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteCCU → BOM → COK → BLR</td>
<td style="text-align: right;">234.0469</td>
<td style="text-align: right;">2661.9103</td>
<td style="text-align: right;">0.0879</td>
<td style="text-align: right;">0.9299</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteCCU → BOM → GOI → BLR</td>
<td style="text-align: right;">-692.7354</td>
<td style="text-align: right;">2694.6428</td>
<td style="text-align: right;">-0.2571</td>
<td style="text-align: right;">0.7971</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteCCU → BOM → HBX → BLR</td>
<td style="text-align: right;">-2509.8879</td>
<td style="text-align: right;">2811.1908</td>
<td style="text-align: right;">-0.8928</td>
<td style="text-align: right;">0.3720</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteCCU → BOM → PNQ → BLR</td>
<td style="text-align: right;">-2434.3810</td>
<td style="text-align: right;">2900.9232</td>
<td style="text-align: right;">-0.8392</td>
<td style="text-align: right;">0.4014</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteCCU → BOM → TRV → BLR</td>
<td style="text-align: right;">-254.0459</td>
<td style="text-align: right;">3155.3647</td>
<td style="text-align: right;">-0.0805</td>
<td style="text-align: right;">0.9358</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteCCU → DEL → AMD → BLR</td>
<td style="text-align: right;">1151.5338</td>
<td style="text-align: right;">2677.9452</td>
<td style="text-align: right;">0.4300</td>
<td style="text-align: right;">0.6672</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteCCU → DEL → BLR</td>
<td style="text-align: right;">4218.6197</td>
<td style="text-align: right;">2482.6556</td>
<td style="text-align: right;">1.6992</td>
<td style="text-align: right;">0.0893</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteCCU → DEL → COK → BLR</td>
<td style="text-align: right;">985.3226</td>
<td style="text-align: right;">2654.9283</td>
<td style="text-align: right;">0.3711</td>
<td style="text-align: right;">0.7105</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteCCU → DEL → COK → TRV → BLR</td>
<td style="text-align: right;">3443.3161</td>
<td style="text-align: right;">2904.0334</td>
<td style="text-align: right;">1.1857</td>
<td style="text-align: right;">0.2358</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteCCU → DEL → VGA → BLR</td>
<td style="text-align: right;">-146.1670</td>
<td style="text-align: right;">2901.7377</td>
<td style="text-align: right;">-0.0504</td>
<td style="text-align: right;">0.9598</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteCCU → GAU → BLR</td>
<td style="text-align: right;">1189.2654</td>
<td style="text-align: right;">2509.9472</td>
<td style="text-align: right;">0.4738</td>
<td style="text-align: right;">0.6356</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteCCU → GAU → DEL → BLR</td>
<td style="text-align: right;">1300.5552</td>
<td style="text-align: right;">2652.6339</td>
<td style="text-align: right;">0.4903</td>
<td style="text-align: right;">0.6239</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteCCU → GAU → IMF → DEL → BLR</td>
<td style="text-align: right;">4185.8371</td>
<td style="text-align: right;">2850.3849</td>
<td style="text-align: right;">1.4685</td>
<td style="text-align: right;">0.1420</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteCCU → HYD → BLR</td>
<td style="text-align: right;">-1442.7784</td>
<td style="text-align: right;">2503.0168</td>
<td style="text-align: right;">-0.5764</td>
<td style="text-align: right;">0.5643</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteCCU → IXA → BLR</td>
<td style="text-align: right;">3110.4021</td>
<td style="text-align: right;">3506.8233</td>
<td style="text-align: right;">0.8870</td>
<td style="text-align: right;">0.3751</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteCCU → IXB → BLR</td>
<td style="text-align: right;">2961.1469</td>
<td style="text-align: right;">2540.9370</td>
<td style="text-align: right;">1.1654</td>
<td style="text-align: right;">0.2439</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteCCU → IXB → DEL → BLR</td>
<td style="text-align: right;">2476.7584</td>
<td style="text-align: right;">3610.9686</td>
<td style="text-align: right;">0.6859</td>
<td style="text-align: right;">0.4928</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteCCU → IXR → BBI → BLR</td>
<td style="text-align: right;">-4950.4482</td>
<td style="text-align: right;">2810.6291</td>
<td style="text-align: right;">-1.7613</td>
<td style="text-align: right;">0.0782</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteCCU → IXR → DEL → BLR</td>
<td style="text-align: right;">-1583.6284</td>
<td style="text-align: right;">2647.9823</td>
<td style="text-align: right;">-0.5981</td>
<td style="text-align: right;">0.5498</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteCCU → IXZ → MAA → BLR</td>
<td style="text-align: right;">-1285.2519</td>
<td style="text-align: right;">3610.8998</td>
<td style="text-align: right;">-0.3559</td>
<td style="text-align: right;">0.7219</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteCCU → JAI → BOM → BLR</td>
<td style="text-align: right;">-1663.9833</td>
<td style="text-align: right;">2711.2240</td>
<td style="text-align: right;">-0.6137</td>
<td style="text-align: right;">0.5394</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteCCU → JAI → DEL → BLR</td>
<td style="text-align: right;">-372.8776</td>
<td style="text-align: right;">2810.7453</td>
<td style="text-align: right;">-0.1327</td>
<td style="text-align: right;">0.8945</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteCCU → KNU → BLR</td>
<td style="text-align: right;">2290.4413</td>
<td style="text-align: right;">2600.7423</td>
<td style="text-align: right;">0.8807</td>
<td style="text-align: right;">0.3785</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteCCU → MAA → BLR</td>
<td style="text-align: right;">-1123.7456</td>
<td style="text-align: right;">2498.7520</td>
<td style="text-align: right;">-0.4497</td>
<td style="text-align: right;">0.6529</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteCCU → NAG → BLR</td>
<td style="text-align: right;">-18.4708</td>
<td style="text-align: right;">2613.8318</td>
<td style="text-align: right;">-0.0071</td>
<td style="text-align: right;">0.9944</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteCCU → PAT → BLR</td>
<td style="text-align: right;">4533.0835</td>
<td style="text-align: right;">2600.7317</td>
<td style="text-align: right;">1.7430</td>
<td style="text-align: right;">0.0814</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteCCU → PNQ → BLR</td>
<td style="text-align: right;">381.2274</td>
<td style="text-align: right;">2544.1226</td>
<td style="text-align: right;">0.1498</td>
<td style="text-align: right;">0.8809</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteCCU → RPR → HYD → BLR</td>
<td style="text-align: right;">-6180.1286</td>
<td style="text-align: right;">3608.8546</td>
<td style="text-align: right;">-1.7125</td>
<td style="text-align: right;">0.0868</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteCCU → VNS → DEL → BLR</td>
<td style="text-align: right;">2670.2839</td>
<td style="text-align: right;">2737.0685</td>
<td style="text-align: right;">0.9756</td>
<td style="text-align: right;">0.3293</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteCCU → VTZ → BLR</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteDEL → AMD → BOM → COK</td>
<td style="text-align: right;">-1113.9883</td>
<td style="text-align: right;">609.5917</td>
<td style="text-align: right;">-1.8274</td>
<td style="text-align: right;">0.0677</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteDEL → AMD → COK</td>
<td style="text-align: right;">-1908.9667</td>
<td style="text-align: right;">798.0112</td>
<td style="text-align: right;">-2.3922</td>
<td style="text-align: right;">0.0168</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteDEL → ATQ → BOM → COK</td>
<td style="text-align: right;">1306.1964</td>
<td style="text-align: right;">711.0793</td>
<td style="text-align: right;">1.8369</td>
<td style="text-align: right;">0.0663</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteDEL → BBI → COK</td>
<td style="text-align: right;">3553.9529</td>
<td style="text-align: right;">1273.1521</td>
<td style="text-align: right;">2.7915</td>
<td style="text-align: right;">0.0053</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteDEL → BDQ → BOM → COK</td>
<td style="text-align: right;">-1419.0583</td>
<td style="text-align: right;">749.5697</td>
<td style="text-align: right;">-1.8932</td>
<td style="text-align: right;">0.0584</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteDEL → BHO → BOM → COK</td>
<td style="text-align: right;">408.4667</td>
<td style="text-align: right;">682.9797</td>
<td style="text-align: right;">0.5981</td>
<td style="text-align: right;">0.5498</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteDEL → BLR → COK</td>
<td style="text-align: right;">-110.8238</td>
<td style="text-align: right;">644.1547</td>
<td style="text-align: right;">-0.1720</td>
<td style="text-align: right;">0.8634</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteDEL → BOM → COK</td>
<td style="text-align: right;">3263.1570</td>
<td style="text-align: right;">624.1415</td>
<td style="text-align: right;">5.2282</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteDEL → CCU → BOM → COK</td>
<td style="text-align: right;">94.8335</td>
<td style="text-align: right;">693.7997</td>
<td style="text-align: right;">0.1367</td>
<td style="text-align: right;">0.8913</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteDEL → COK</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteDEL → DED → BOM → COK</td>
<td style="text-align: right;">5701.1730</td>
<td style="text-align: right;">1848.2657</td>
<td style="text-align: right;">3.0846</td>
<td style="text-align: right;">0.0020</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteDEL → GOI → BOM → COK</td>
<td style="text-align: right;">-2189.5779</td>
<td style="text-align: right;">669.7220</td>
<td style="text-align: right;">-3.2694</td>
<td style="text-align: right;">0.0011</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteDEL → GWL → IDR → BOM → COK</td>
<td style="text-align: right;">6864.8105</td>
<td style="text-align: right;">1069.5949</td>
<td style="text-align: right;">6.4181</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteDEL → HYD → BOM → COK</td>
<td style="text-align: right;">-2122.7315</td>
<td style="text-align: right;">671.9196</td>
<td style="text-align: right;">-3.1592</td>
<td style="text-align: right;">0.0016</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteDEL → HYD → COK</td>
<td style="text-align: right;">-279.3114</td>
<td style="text-align: right;">638.2682</td>
<td style="text-align: right;">-0.4376</td>
<td style="text-align: right;">0.6617</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteDEL → HYD → MAA → COK</td>
<td style="text-align: right;">-4593.4733</td>
<td style="text-align: right;">645.6063</td>
<td style="text-align: right;">-7.1150</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteDEL → IDR → BOM → COK</td>
<td style="text-align: right;">-282.8132</td>
<td style="text-align: right;">636.6398</td>
<td style="text-align: right;">-0.4442</td>
<td style="text-align: right;">0.6569</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteDEL → IXC → BOM → COK</td>
<td style="text-align: right;">-1571.9349</td>
<td style="text-align: right;">902.6048</td>
<td style="text-align: right;">-1.7416</td>
<td style="text-align: right;">0.0816</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteDEL → IXU → BOM → COK</td>
<td style="text-align: right;">4922.1676</td>
<td style="text-align: right;">981.6628</td>
<td style="text-align: right;">5.0141</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteDEL → JAI → BOM → COK</td>
<td style="text-align: right;">-1472.0712</td>
<td style="text-align: right;">606.8210</td>
<td style="text-align: right;">-2.4259</td>
<td style="text-align: right;">0.0153</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteDEL → JDH → BOM → COK</td>
<td style="text-align: right;">2474.6039</td>
<td style="text-align: right;">713.9009</td>
<td style="text-align: right;">3.4663</td>
<td style="text-align: right;">0.0005</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteDEL → LKO → BOM → COK</td>
<td style="text-align: right;">-522.1773</td>
<td style="text-align: right;">701.2905</td>
<td style="text-align: right;">-0.7446</td>
<td style="text-align: right;">0.4565</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteDEL → LKO → COK</td>
<td style="text-align: right;">-336.6429</td>
<td style="text-align: right;">867.8025</td>
<td style="text-align: right;">-0.3879</td>
<td style="text-align: right;">0.6981</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteDEL → MAA → BOM → COK</td>
<td style="text-align: right;">-4728.6995</td>
<td style="text-align: right;">852.0184</td>
<td style="text-align: right;">-5.5500</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteDEL → MAA → COK</td>
<td style="text-align: right;">-442.2079</td>
<td style="text-align: right;">655.1116</td>
<td style="text-align: right;">-0.6750</td>
<td style="text-align: right;">0.4997</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteDEL → NAG → BOM → COK</td>
<td style="text-align: right;">-1471.1202</td>
<td style="text-align: right;">654.6183</td>
<td style="text-align: right;">-2.2473</td>
<td style="text-align: right;">0.0246</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteDEL → PNQ → COK</td>
<td style="text-align: right;">-882.6067</td>
<td style="text-align: right;">733.8771</td>
<td style="text-align: right;">-1.2027</td>
<td style="text-align: right;">0.2291</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteDEL → RPR → NAG → BOM → COK</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteDEL → TRV → COK</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">RouteDEL → UDR → BOM → COK</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RouteMAA → CCU</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>

</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model summary statistics</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>model_stats <span class="ot">&lt;-</span> <span class="fu">glance</span>(regression.flight) <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(r.squared, adj.r.squared, sigma, statistic, p.value, df, nobs) <span class="sc">%&gt;%</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">4</span>)))</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>model_stats <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Model Summary Statistics"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Model Summary Statistics</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">r.squared</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">adj.r.squared</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sigma</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.6332</td>
<td style="text-align: right;">0.6288</td>
<td style="text-align: right;">2479.698</td>
<td style="text-align: right;">143.2589</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">10499</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="regressions-like-a-data-scientist" class="level1">
<h1>Regressions like a Data Scientist</h1>
<p>If I free myself from needing to rely on theory to make predictions, I would go with an All Subsets regression approach, which essentially tests every combination of possible variables, calculates the variance predicted and various model fit statistics (AIC, BIC, etc.) and selects the model with the highest predicted variances and lowest model fit statistics.</p>
<p>While I’ve done this analysis before in SPSS, I had not yet done it in R, so I had Claude help me write the code.</p>
<section id="preparing-data-for-all-subsets-regression" class="level2">
<h2 class="anchored" data-anchor-id="preparing-data-for-all-subsets-regression">Preparing Data for All Subsets Regression</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>flight_data8 <span class="ot">&lt;-</span> flight_data7 <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">number_of_stops =</span> <span class="fu">case_when</span>(Total_Stops <span class="sc">==</span> <span class="st">"non-stop"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>                                     Total_Stops <span class="sc">==</span> <span class="st">"1 stop"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                                     Total_Stops <span class="sc">==</span> <span class="st">"2 stops"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>                                     Total_Stops <span class="sc">==</span> <span class="st">"3 stops"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>                                     Total_Stops <span class="sc">==</span> <span class="st">"4 stops"</span> <span class="sc">~</span> <span class="dv">4</span>),</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">weekend =</span> <span class="fu">case_when</span>(departure_day_of_week <span class="sc">==</span> <span class="st">"Sunday"</span> <span class="sc">|</span> departure_day_of_week <span class="sc">==</span> <span class="st">"Saturday"</span> <span class="sc">~</span> <span class="st">"Weekend"</span>,</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>                             <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Weekday"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Adding random variables for comparison</strong></p>
<p>Now I’m going to add a random categorical and a random continuous feature to my variable</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>flight_data8<span class="sc">$</span>random_categorical <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">'red'</span>, <span class="st">'orange'</span>, <span class="st">'yellow'</span>, <span class="st">'green'</span>, <span class="st">'blue'</span>), <span class="fu">nrow</span>(flight_data8), <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>flight_data8<span class="sc">$</span>random_continuous <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="fu">nrow</span>(flight_data8), <span class="at">replace =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="variable-selection-via-standardized-regression" class="level2">
<h2 class="anchored" data-anchor-id="variable-selection-via-standardized-regression">Variable Selection via Standardized Regression</h2>
<p><strong>First, I identify the variables in the model.</strong></p>
<p>I’m going to do that by running a regular standardized linear regression. Whichever variables have higher standardized values than the random variables will not be included.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>regression.flight <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># Continuous</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">scale</span>(Departure_Day) <span class="sc">+</span> <span class="fu">scale</span>(Departure_Month) <span class="sc">+</span> <span class="fu">scale</span>(Departure_Hour) <span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">scale</span>(number_of_stops) <span class="sc">+</span> <span class="fu">scale</span>(Duration_Hours) <span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">scale</span>(random_continuous) <span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># Dichotomous</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>                          weekend <span class="sc">+</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># Categorical</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>                          Airline <span class="sc">+</span> random_categorical <span class="sc">+</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>                          airport_code_departure <span class="sc">+</span> airport_code_first_stop <span class="sc">+</span> airport_code_second_stop <span class="sc">+</span> </span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>                          airport_code_third_stop <span class="sc">+</span> airport_code_arrival <span class="sc">+</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># Dates </span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>                          departure_date_time <span class="sc">+</span> arrival_date_time, </span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> flight_data8)</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at those regression coefficients</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>regression_coefficients <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(regression.flight<span class="sc">$</span>coefficients)</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>regression_coefficients <span class="sc">%&gt;%</span> </span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">abs_coef =</span> <span class="fu">abs</span>(regression.flight.coefficients)) <span class="sc">%&gt;%</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(abs_coef)) <span class="sc">%&gt;%</span></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(abs_coef) <span class="sc">%&gt;%</span></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Smallest Regression Coefficients (Bottom 20)"</span>,</span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Coefficient"</span>, <span class="st">"Absolute Value"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Smallest Regression Coefficients (Bottom 20)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Coefficient</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Absolute Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">departure_date_time</td>
<td style="text-align: right;">-0.0080827</td>
<td style="text-align: right;">0.0080827</td>
</tr>
<tr class="even">
<td style="text-align: left;">random_categoricalyellow</td>
<td style="text-align: right;">-244.6025366</td>
<td style="text-align: right;">244.6025366</td>
</tr>
<tr class="odd">
<td style="text-align: left;">scale(random_continuous)</td>
<td style="text-align: right;">-346.7734846</td>
<td style="text-align: right;">346.7734846</td>
</tr>
<tr class="even">
<td style="text-align: left;">random_categoricalgreen</td>
<td style="text-align: right;">402.1820603</td>
<td style="text-align: right;">402.1820603</td>
</tr>
<tr class="odd">
<td style="text-align: left;">random_categoricalred</td>
<td style="text-align: right;">-798.8240139</td>
<td style="text-align: right;">798.8240139</td>
</tr>
<tr class="even">
<td style="text-align: left;">airport_code_first_stopDEL</td>
<td style="text-align: right;">-903.0900151</td>
<td style="text-align: right;">903.0900151</td>
</tr>
<tr class="odd">
<td style="text-align: left;">weekendWeekend</td>
<td style="text-align: right;">916.9317733</td>
<td style="text-align: right;">916.9317733</td>
</tr>
<tr class="even">
<td style="text-align: left;">random_categoricalorange</td>
<td style="text-align: right;">-937.2492457</td>
<td style="text-align: right;">937.2492457</td>
</tr>
<tr class="odd">
<td style="text-align: left;">airport_code_first_stopGAU</td>
<td style="text-align: right;">-1264.1464170</td>
<td style="text-align: right;">1264.1464170</td>
</tr>
<tr class="even">
<td style="text-align: left;">scale(Duration_Hours)</td>
<td style="text-align: right;">-1390.9415684</td>
<td style="text-align: right;">1390.9415684</td>
</tr>
<tr class="odd">
<td style="text-align: left;">scale(Departure_Hour)</td>
<td style="text-align: right;">-1563.5123957</td>
<td style="text-align: right;">1563.5123957</td>
</tr>
<tr class="even">
<td style="text-align: left;">airport_code_third_stopNAG</td>
<td style="text-align: right;">2757.8345189</td>
<td style="text-align: right;">2757.8345189</td>
</tr>
<tr class="odd">
<td style="text-align: left;">airport_code_first_stopBLR</td>
<td style="text-align: right;">-2911.6702836</td>
<td style="text-align: right;">2911.6702836</td>
</tr>
<tr class="even">
<td style="text-align: left;">airport_code_first_stopCCU</td>
<td style="text-align: right;">3788.4572153</td>
<td style="text-align: right;">3788.4572153</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AirlineMultiple carriers</td>
<td style="text-align: right;">4087.9618357</td>
<td style="text-align: right;">4087.9618357</td>
</tr>
<tr class="even">
<td style="text-align: left;">scale(Departure_Day)</td>
<td style="text-align: right;">5473.3816941</td>
<td style="text-align: right;">5473.3816941</td>
</tr>
<tr class="odd">
<td style="text-align: left;">airport_code_departureDEL</td>
<td style="text-align: right;">5693.1120953</td>
<td style="text-align: right;">5693.1120953</td>
</tr>
<tr class="even">
<td style="text-align: left;">airport_code_third_stopBHO</td>
<td style="text-align: right;">5845.9056184</td>
<td style="text-align: right;">5845.9056184</td>
</tr>
<tr class="odd">
<td style="text-align: left;">airport_code_first_stopBOM</td>
<td style="text-align: right;">7465.1719480</td>
<td style="text-align: right;">7465.1719480</td>
</tr>
<tr class="even">
<td style="text-align: left;">airport_code_departureCCU</td>
<td style="text-align: right;">7621.7397846</td>
<td style="text-align: right;">7621.7397846</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>For my continuous variables, departure_date_time did a worse job predicting than the random continuous variable. For my categorical variables, nothing did worse.</p>
</section>
<section id="streamlined-all-subsets-regression" class="level2">
<h2 class="anchored" data-anchor-id="streamlined-all-subsets-regression">Streamlined All Subsets Regression</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>predictor_variables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="co"># Continuous</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Departure_Day"</span>, <span class="st">"Departure_Month"</span>, <span class="st">"Departure_Hour"</span>,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"number_of_stops"</span>, <span class="st">"Duration_Hours"</span>,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># Dichotomous</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"weekend"</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># Lower-cardinality Categorical (keeping only essential ones)</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Airline"</span>, <span class="st">"airport_code_departure"</span>, <span class="st">"airport_code_first_stop"</span>, </span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"airport_code_second_stop"</span>, <span class="st">"airport_code_third_stop"</span>, <span class="st">"airport_code_arrival"</span>)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>outcome_variable <span class="ot">&lt;-</span> <span class="st">"Price"</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== STREAMLINED ALL SUBSETS REGRESSION ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== STREAMLINED ALL SUBSETS REGRESSION ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Testing"</span>, <span class="fu">length</span>(predictor_variables), <span class="st">"predictor variables</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Testing 12 predictor variables</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"This will test up to"</span>, <span class="dv">2</span><span class="sc">^</span><span class="fu">length</span>(predictor_variables) <span class="sc">-</span> <span class="dv">1</span>, <span class="st">"different model combinations</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>This will test up to 4095 different model combinations</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Variables included:"</span>, <span class="fu">paste</span>(predictor_variables, <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Variables included: Departure_Day, Departure_Month, Departure_Hour, number_of_stops, Duration_Hours, weekend, Airline, airport_code_departure, airport_code_first_stop, airport_code_second_stop, airport_code_third_stop, airport_code_arrival </code></pre>
</div>
</div>
<p><strong>Data exploration function to check cardinality</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>check_variable_cardinality <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">data =</span> flight_data8, <span class="at">vars =</span> predictor_variables) {</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">"flight_data8"</span>)) {</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"flight_data8 not found</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  cardinality_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> <span class="fu">character</span>(),</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Unique_Values =</span> <span class="fu">numeric</span>(),</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Warning =</span> <span class="fu">character</span>(),</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (var <span class="cf">in</span> vars) {</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (var <span class="sc">%in%</span> <span class="fu">names</span>(data)) {</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>      unique_vals <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(data[[var]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>      warning_msg <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(unique_vals <span class="sc">&gt;</span> <span class="dv">50</span>, <span class="st">"High cardinality - may cause issues"</span>, <span class="st">""</span>)</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>      cardinality_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cardinality_results, </span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">data.frame</span>(<span class="at">Variable =</span> var, </span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">Unique_Values =</span> unique_vals, </span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">Warning =</span> warning_msg))</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>      cardinality_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cardinality_results, </span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">data.frame</span>(<span class="at">Variable =</span> var, </span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">Unique_Values =</span> <span class="cn">NA</span>, </span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">Warning =</span> <span class="st">"NOT FOUND in dataset"</span>))</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cardinality_results)</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>cardinality_check <span class="ot">&lt;-</span> <span class="fu">check_variable_cardinality</span>()</span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>cardinality_check <span class="sc">%&gt;%</span></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Variable Cardinality Check"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Variable Cardinality Check</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Unique_Values</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Warning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Departure_Day</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Departure_Month</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Departure_Hour</td>
<td style="text-align: right;">24</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">number_of_stops</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Duration_Hours</td>
<td style="text-align: right;">366</td>
<td style="text-align: left;">High cardinality - may cause issues</td>
</tr>
<tr class="even">
<td style="text-align: left;">weekend</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Airline</td>
<td style="text-align: right;">11</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">airport_code_departure</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">airport_code_first_stop</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">airport_code_second_stop</td>
<td style="text-align: right;">26</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">airport_code_third_stop</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">airport_code_arrival</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong>Method 1: Using the leaps package (most efficient)</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>flight_all_subsets_leaps <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">data =</span> flight_data8, <span class="at">outcome_var =</span> <span class="st">"Price"</span>, </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">predictor_vars =</span> predictor_variables, <span class="at">method =</span> <span class="st">"exhaustive"</span>) {</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if data exists</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">"flight_data8"</span>)) {</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"flight_data8 dataset not found. Please load your data first."</span>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove rows with missing values in key variables</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  analysis_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(outcome_var, predictor_vars))) <span class="sc">%&gt;%</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">na.omit</span>()</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Analysis dataset created with"</span>, <span class="fu">nrow</span>(analysis_data), <span class="st">"complete observations</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Original dataset had"</span>, <span class="fu">nrow</span>(data), <span class="st">"observations</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Run all subsets regression with really.big=TRUE for safety</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Running all subsets regression...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>  regsubsets_result <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(<span class="fu">formula</span>(<span class="fu">paste</span>(outcome_var, <span class="st">"~"</span>, <span class="fu">paste</span>(predictor_vars, <span class="at">collapse =</span> <span class="st">" + "</span>))), </span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">data =</span> analysis_data, </span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">nbest =</span> <span class="dv">1</span>,        <span class="co"># Keep best model of each size</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">nvmax =</span> <span class="fu">length</span>(predictor_vars),  <span class="co"># Max variables</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">method =</span> method,   <span class="co"># "exhaustive", "forward", "backward"</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">really.big =</span> <span class="cn">TRUE</span>) <span class="co"># Handle large searches</span></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract results</span></span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>  summary_results <span class="ot">&lt;-</span> <span class="fu">summary</span>(regsubsets_result)</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create results data frame</span></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>  results_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_variables =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(summary_results<span class="sc">$</span>rsq),</span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">r_squared =</span> summary_results<span class="sc">$</span>rsq,</span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">adj_r_squared =</span> summary_results<span class="sc">$</span>adjr2,</span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">cp =</span> summary_results<span class="sc">$</span>cp,</span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">bic =</span> summary_results<span class="sc">$</span>bic,</span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">variables_included =</span> <span class="fu">apply</span>(summary_results<span class="sc">$</span>which[,<span class="sc">-</span><span class="dv">1</span>], <span class="dv">1</span>, <span class="cf">function</span>(x) {</span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste</span>(<span class="fu">names</span>(x)[x], <span class="at">collapse =</span> <span class="st">", "</span>)</span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find best models by different criteria</span></span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a>  best_rsq_idx <span class="ot">&lt;-</span> <span class="fu">which.max</span>(results_df<span class="sc">$</span>r_squared)</span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a>  best_adj_rsq_idx <span class="ot">&lt;-</span> <span class="fu">which.max</span>(results_df<span class="sc">$</span>adj_r_squared)</span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a>  best_cp_idx <span class="ot">&lt;-</span> <span class="fu">which.min</span>(results_df<span class="sc">$</span>cp)</span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a>  best_bic_idx <span class="ot">&lt;-</span> <span class="fu">which.min</span>(results_df<span class="sc">$</span>bic)</span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-47"><a href="#cb60-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add indicator columns</span></span>
<span id="cb60-48"><a href="#cb60-48" aria-hidden="true" tabindex="-1"></a>  results_df<span class="sc">$</span>best_rsq <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(results_df) <span class="sc">==</span> best_rsq_idx</span>
<span id="cb60-49"><a href="#cb60-49" aria-hidden="true" tabindex="-1"></a>  results_df<span class="sc">$</span>best_adj_rsq <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(results_df) <span class="sc">==</span> best_adj_rsq_idx</span>
<span id="cb60-50"><a href="#cb60-50" aria-hidden="true" tabindex="-1"></a>  results_df<span class="sc">$</span>best_cp <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(results_df) <span class="sc">==</span> best_cp_idx</span>
<span id="cb60-51"><a href="#cb60-51" aria-hidden="true" tabindex="-1"></a>  results_df<span class="sc">$</span>best_bic <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(results_df) <span class="sc">==</span> best_bic_idx</span>
<span id="cb60-52"><a href="#cb60-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-53"><a href="#cb60-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb60-54"><a href="#cb60-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">results =</span> results_df,</span>
<span id="cb60-55"><a href="#cb60-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">regsubsets_object =</span> regsubsets_result,</span>
<span id="cb60-56"><a href="#cb60-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">analysis_data =</span> analysis_data,</span>
<span id="cb60-57"><a href="#cb60-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">best_models =</span> <span class="fu">list</span>(</span>
<span id="cb60-58"><a href="#cb60-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">highest_rsq =</span> results_df[best_rsq_idx, ],</span>
<span id="cb60-59"><a href="#cb60-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">best_adj_rsq =</span> results_df[best_adj_rsq_idx, ],</span>
<span id="cb60-60"><a href="#cb60-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">best_cp =</span> results_df[best_cp_idx, ],</span>
<span id="cb60-61"><a href="#cb60-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">best_bic =</span> results_df[best_bic_idx, ]</span>
<span id="cb60-62"><a href="#cb60-62" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-63"><a href="#cb60-63" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb60-64"><a href="#cb60-64" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Alternative: Forward/Backward Selection (faster and handles dependencies better)</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>flight_stepwise_selection <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">data =</span> flight_data8, <span class="at">outcome_var =</span> <span class="st">"Price"</span>, </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">predictor_vars =</span> predictor_variables, <span class="at">method =</span> <span class="st">"both"</span>) {</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if data exists</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">"flight_data8"</span>)) {</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"flight_data8 dataset not found. Please load your data first."</span>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove rows with missing values in key variables</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  analysis_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(outcome_var, predictor_vars))) <span class="sc">%&gt;%</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">na.omit</span>()</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Stepwise selection dataset created with"</span>, <span class="fu">nrow</span>(analysis_data), <span class="st">"complete observations</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Original dataset had"</span>, <span class="fu">nrow</span>(data), <span class="st">"observations</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create full model formula</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>  full_formula <span class="ot">&lt;-</span> <span class="fu">formula</span>(<span class="fu">paste</span>(outcome_var, <span class="st">"~"</span>, <span class="fu">paste</span>(predictor_vars, <span class="at">collapse =</span> <span class="st">" + "</span>)))</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit full model</span></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>  full_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(full_formula, <span class="at">data =</span> analysis_data)</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform stepwise selection</span></span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Performing stepwise selection (method ="</span>, method, <span class="st">")...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"forward"</span>) {</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Start with null model for forward selection</span></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>    null_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">formula</span>(<span class="fu">paste</span>(outcome_var, <span class="st">"~ 1"</span>)), <span class="at">data =</span> analysis_data)</span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>    step_model <span class="ot">&lt;-</span> <span class="fu">step</span>(null_model, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> null_model, <span class="at">upper =</span> full_model), </span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="st">"forward"</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"backward"</span>) {</span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Start with full model for backward selection</span></span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>    step_model <span class="ot">&lt;-</span> <span class="fu">step</span>(full_model, <span class="at">direction =</span> <span class="st">"backward"</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Both directions</span></span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a>    step_model <span class="ot">&lt;-</span> <span class="fu">step</span>(full_model, <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get model summary</span></span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a>  step_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(step_model)</span>
<span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== STEPWISE SELECTION RESULTS ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb61-42"><a href="#cb61-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Final model R-squared:"</span>, <span class="fu">round</span>(step_summary<span class="sc">$</span>r.squared, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb61-43"><a href="#cb61-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Final model Adjusted R-squared:"</span>, <span class="fu">round</span>(step_summary<span class="sc">$</span>adj.r.squared, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb61-44"><a href="#cb61-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Variables selected:"</span>, <span class="fu">length</span>(step_model<span class="sc">$</span>coefficients) <span class="sc">-</span> <span class="dv">1</span>, <span class="st">"out of"</span>, <span class="fu">length</span>(predictor_vars), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb61-45"><a href="#cb61-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Variables in final model:"</span>, <span class="fu">paste</span>(<span class="fu">names</span>(step_model<span class="sc">$</span>coefficients)[<span class="sc">-</span><span class="dv">1</span>], <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb61-46"><a href="#cb61-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-47"><a href="#cb61-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb61-48"><a href="#cb61-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">model =</span> step_model,</span>
<span id="cb61-49"><a href="#cb61-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">summary =</span> step_summary,</span>
<span id="cb61-50"><a href="#cb61-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">aic =</span> <span class="fu">AIC</span>(step_model),</span>
<span id="cb61-51"><a href="#cb61-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">bic =</span> <span class="fu">BIC</span>(step_model),</span>
<span id="cb61-52"><a href="#cb61-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> <span class="fu">formula</span>(step_model),</span>
<span id="cb61-53"><a href="#cb61-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">variables_selected =</span> <span class="fu">names</span>(step_model<span class="sc">$</span>coefficients)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb61-54"><a href="#cb61-54" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb61-55"><a href="#cb61-55" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Visualization function</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>plot_flight_model_comparison <span class="ot">&lt;-</span> <span class="cf">function</span>(results_df, <span class="at">top_n =</span> <span class="dv">15</span>) {</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get top models</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  top_models <span class="ot">&lt;-</span> <span class="fu">head</span>(results_df, top_n)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the plot</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> top_models <span class="sc">%&gt;%</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">variables_wrapped =</span> <span class="fu">str_wrap</span>(variables_included, <span class="at">width =</span> <span class="dv">50</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">variables_wrapped =</span> <span class="fu">fct_reorder</span>(variables_wrapped, r_squared)) <span class="sc">%&gt;%</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> variables_wrapped, <span class="at">y =</span> r_squared)) <span class="sc">+</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'identity'</span>, <span class="at">fill =</span> <span class="st">'steelblue'</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(r_squared, <span class="dv">3</span>))), </span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">hjust =</span> <span class="sc">-</span>.<span class="dv">1</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fontface =</span> <span class="st">'bold'</span>) <span class="sc">+</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">color =</span> <span class="st">"#666666"</span>),</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Top"</span>, top_n, <span class="st">"Flight Price Prediction Models by R-squared"</span>),</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Variable Combinations"</span>, </span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"R-squared"</span>,</span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">"Total combinations tested:"</span>, <span class="fu">nrow</span>(results_df)))</span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Helper function to get detailed results for best flight price model</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>get_best_flight_model_details <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">data =</span> flight_data8, <span class="at">outcome_var =</span> <span class="st">"Price"</span>, model_variables_string) {</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Parse the variable string to extract original variable names</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  original_vars <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check for each of our streamlined predictor variables</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"Airline"</span>, model_variables_string)) {</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    original_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(original_vars, <span class="st">"Airline"</span>)</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"Departure_Day"</span>, model_variables_string)) {</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    original_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(original_vars, <span class="st">"Departure_Day"</span>)</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"Departure_Month"</span>, model_variables_string)) {</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>    original_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(original_vars, <span class="st">"Departure_Month"</span>)</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"Departure_Hour"</span>, model_variables_string)) {</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>    original_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(original_vars, <span class="st">"Departure_Hour"</span>)</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"weekend"</span>, model_variables_string)) {</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>    original_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(original_vars, <span class="st">"weekend"</span>)</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"airport_code_departure"</span>, model_variables_string)) {</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>    original_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(original_vars, <span class="st">"airport_code_departure"</span>)</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"airport_code_first_stop"</span>, model_variables_string)) {</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>    original_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(original_vars, <span class="st">"airport_code_first_stop"</span>)</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"airport_code_second_stop"</span>, model_variables_string)) {</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>    original_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(original_vars, <span class="st">"airport_code_second_stop"</span>)</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"airport_code_third_stop"</span>, model_variables_string)) {</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>    original_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(original_vars, <span class="st">"airport_code_third_stop"</span>)</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"airport_code_arrival"</span>, model_variables_string)) {</span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>    original_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(original_vars, <span class="st">"airport_code_arrival"</span>)</span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"number_of_stops"</span>, model_variables_string)) {</span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>    original_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(original_vars, <span class="st">"number_of_stops"</span>)</span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"Duration_Hours"</span>, model_variables_string)) {</span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>    original_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(original_vars, <span class="st">"Duration_Hours"</span>)</span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove rows with missing values using original variable names</span></span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a>  analysis_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(outcome_var, original_vars))) <span class="sc">%&gt;%</span></span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">na.omit</span>()</span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create formula with original variables</span></span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a>  formula_str <span class="ot">&lt;-</span> <span class="fu">paste</span>(outcome_var, <span class="st">"~"</span>, <span class="fu">paste</span>(original_vars, <span class="at">collapse =</span> <span class="st">" + "</span>))</span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the model</span></span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a>  best_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">as.formula</span>(formula_str), <span class="at">data =</span> analysis_data)</span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get detailed summary</span></span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a>  model_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(best_model)</span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"=== BEST STREAMLINED FLIGHT PRICE PREDICTION MODEL ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Original Variables Used ("</span>, <span class="fu">length</span>(original_vars), <span class="st">"total):"</span>, <span class="fu">paste</span>(original_vars, <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"R-squared:"</span>, <span class="fu">round</span>(model_summary<span class="sc">$</span>r.squared, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb63-61"><a href="#cb63-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Adjusted R-squared:"</span>, <span class="fu">round</span>(model_summary<span class="sc">$</span>adj.r.squared, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb63-62"><a href="#cb63-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"F-statistic:"</span>, <span class="fu">round</span>(model_summary<span class="sc">$</span>fstatistic[<span class="dv">1</span>], <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb63-63"><a href="#cb63-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"P-value:"</span>, <span class="fu">format.pval</span>(<span class="fu">pf</span>(model_summary<span class="sc">$</span>fstatistic[<span class="dv">1</span>], </span>
<span id="cb63-64"><a href="#cb63-64" aria-hidden="true" tabindex="-1"></a>                                 model_summary<span class="sc">$</span>fstatistic[<span class="dv">2</span>], </span>
<span id="cb63-65"><a href="#cb63-65" aria-hidden="true" tabindex="-1"></a>                                 model_summary<span class="sc">$</span>fstatistic[<span class="dv">3</span>], </span>
<span id="cb63-66"><a href="#cb63-66" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb63-67"><a href="#cb63-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Number of observations:"</span>, <span class="fu">nrow</span>(analysis_data), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb63-68"><a href="#cb63-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-69"><a href="#cb63-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(best_model)</span>
<span id="cb63-70"><a href="#cb63-70" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="final-results" class="level2">
<h2 class="anchored" data-anchor-id="final-results">Final Results</h2>
<p><strong>Run the analysis on your flight data</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">"flight_data8"</span>)) {</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"=== RUNNING STREAMLINED ALL SUBSETS REGRESSION ON FLIGHT PRICE DATA ===</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># First, check the cardinality of variables to identify potential issues</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_variable_cardinality</span>()</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Method 1: Try exhaustive search with streamlined variables</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Attempting exhaustive search with streamlined variables...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>    leaps_results <span class="ot">&lt;-</span> <span class="fu">flight_all_subsets_leaps</span>()</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get detailed results for the model with highest R-squared</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>    best_model_rsq <span class="ot">&lt;-</span> <span class="fu">get_best_flight_model_details</span>(<span class="at">model_variables_string =</span> leaps_results<span class="sc">$</span>best_models<span class="sc">$</span>highest_rsq<span class="sc">$</span>variables_included)</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get detailed results for the model with best BIC (often better for prediction)</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>    best_model_bic <span class="ot">&lt;-</span> <span class="fu">get_best_flight_model_details</span>(<span class="at">model_variables_string =</span> leaps_results<span class="sc">$</span>best_models<span class="sc">$</span>best_bic<span class="sc">$</span>variables_included)</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Exhaustive search failed:"</span>, e<span class="sc">$</span>message, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Switching to stepwise selection method...</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Method 2: Stepwise selection (more robust for categorical variables)</span></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"=== RUNNING STEPWISE SELECTION (ALTERNATIVE METHOD) ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Forward selection</span></span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"1. Forward Selection:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>    forward_results <span class="ot">&lt;-</span> <span class="fu">flight_stepwise_selection</span>(<span class="at">method =</span> <span class="st">"forward"</span>)</span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Backward selection  </span></span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">2. Backward Selection:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>    backward_results <span class="ot">&lt;-</span> <span class="fu">flight_stepwise_selection</span>(<span class="at">method =</span> <span class="st">"backward"</span>)</span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Both directions</span></span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">3. Bidirectional Selection:</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a>    both_results <span class="ot">&lt;-</span> <span class="fu">flight_stepwise_selection</span>(<span class="at">method =</span> <span class="st">"both"</span>)</span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compare the three methods</span></span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== COMPARISON OF STEPWISE METHODS ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a>    comparison_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">"Forward"</span>, <span class="st">"Backward"</span>, <span class="st">"Both"</span>),</span>
<span id="cb64-42"><a href="#cb64-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">R_squared =</span> <span class="fu">c</span>(<span class="fu">summary</span>(forward_results<span class="sc">$</span>model)<span class="sc">$</span>r.squared,</span>
<span id="cb64-43"><a href="#cb64-43" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">summary</span>(backward_results<span class="sc">$</span>model)<span class="sc">$</span>r.squared, </span>
<span id="cb64-44"><a href="#cb64-44" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">summary</span>(both_results<span class="sc">$</span>model)<span class="sc">$</span>r.squared),</span>
<span id="cb64-45"><a href="#cb64-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">Adj_R_squared =</span> <span class="fu">c</span>(<span class="fu">summary</span>(forward_results<span class="sc">$</span>model)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb64-46"><a href="#cb64-46" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">summary</span>(backward_results<span class="sc">$</span>model)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb64-47"><a href="#cb64-47" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">summary</span>(both_results<span class="sc">$</span>model)<span class="sc">$</span>adj.r.squared),</span>
<span id="cb64-48"><a href="#cb64-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">AIC =</span> <span class="fu">c</span>(forward_results<span class="sc">$</span>aic, backward_results<span class="sc">$</span>aic, both_results<span class="sc">$</span>aic),</span>
<span id="cb64-49"><a href="#cb64-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">BIC =</span> <span class="fu">c</span>(forward_results<span class="sc">$</span>bic, backward_results<span class="sc">$</span>bic, both_results<span class="sc">$</span>bic),</span>
<span id="cb64-50"><a href="#cb64-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">N_Variables =</span> <span class="fu">c</span>(<span class="fu">length</span>(forward_results<span class="sc">$</span>variables_selected),</span>
<span id="cb64-51"><a href="#cb64-51" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">length</span>(backward_results<span class="sc">$</span>variables_selected),</span>
<span id="cb64-52"><a href="#cb64-52" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">length</span>(both_results<span class="sc">$</span>variables_selected))</span>
<span id="cb64-53"><a href="#cb64-53" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb64-54"><a href="#cb64-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(comparison_df)</span>
<span id="cb64-55"><a href="#cb64-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-56"><a href="#cb64-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recommend best model</span></span>
<span id="cb64-57"><a href="#cb64-57" aria-hidden="true" tabindex="-1"></a>    best_method_idx <span class="ot">&lt;-</span> <span class="fu">which.max</span>(comparison_df<span class="sc">$</span>Adj_R_squared)</span>
<span id="cb64-58"><a href="#cb64-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RECOMMENDED MODEL: "</span>, comparison_df<span class="sc">$</span>Method[best_method_idx], </span>
<span id="cb64-59"><a href="#cb64-59" aria-hidden="true" tabindex="-1"></a>        <span class="st">" (Highest Adjusted R-squared: "</span>, <span class="fu">round</span>(comparison_df<span class="sc">$</span>Adj_R_squared[best_method_idx], <span class="dv">4</span>), <span class="st">")</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb64-60"><a href="#cb64-60" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb64-61"><a href="#cb64-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-62"><a href="#cb64-62" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb64-63"><a href="#cb64-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"ERROR: flight_data8 dataset not found!</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb64-64"><a href="#cb64-64" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Results Summary - All Models Ranked by Number of Variables:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display results summary in a nice table</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">"leaps_results"</span>)) {</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  leaps_results<span class="sc">$</span>results <span class="sc">%&gt;%</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(n_variables, r_squared, adj_r_squared, cp, bic) <span class="sc">%&gt;%</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">4</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"All Subsets Regression Results Summary"</span>,</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"# Variables"</span>, <span class="st">"R-squared"</span>, <span class="st">"Adj R-squared"</span>, <span class="st">"Cp"</span>, <span class="st">"BIC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>All Subsets Regression Results Summary</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th"># Variables</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">R-squared</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Adj R-squared</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Cp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.4723</td>
<td style="text-align: right;">0.4601</td>
<td style="text-align: right;">-54.4857</td>
<td style="text-align: right;">-21.1550</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.5813</td>
<td style="text-align: right;">0.5614</td>
<td style="text-align: right;">-49.7011</td>
<td style="text-align: right;">-27.7562</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.6597</td>
<td style="text-align: right;">0.6348</td>
<td style="text-align: right;">-45.6978</td>
<td style="text-align: right;">-33.2769</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.7190</td>
<td style="text-align: right;">0.6909</td>
<td style="text-align: right;">-42.1812</td>
<td style="text-align: right;">-38.0927</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.7655</td>
<td style="text-align: right;">0.7354</td>
<td style="text-align: right;">-38.9934</td>
<td style="text-align: right;">-42.4220</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.7802</td>
<td style="text-align: right;">0.7455</td>
<td style="text-align: right;">-36.6181</td>
<td style="text-align: right;">-41.5250</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.7939</td>
<td style="text-align: right;">0.7548</td>
<td style="text-align: right;">-34.2687</td>
<td style="text-align: right;">-40.6085</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.8072</td>
<td style="text-align: right;">0.7644</td>
<td style="text-align: right;">-31.9263</td>
<td style="text-align: right;">-39.8255</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">0.8152</td>
<td style="text-align: right;">0.7677</td>
<td style="text-align: right;">-29.7233</td>
<td style="text-align: right;">-37.9125</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.8216</td>
<td style="text-align: right;">0.7691</td>
<td style="text-align: right;">-27.5596</td>
<td style="text-align: right;">-35.6924</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: right;">0.8320</td>
<td style="text-align: right;">0.7761</td>
<td style="text-align: right;">-25.2925</td>
<td style="text-align: right;">-34.6022</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.8377</td>
<td style="text-align: right;">0.7768</td>
<td style="text-align: right;">-23.1491</td>
<td style="text-align: right;">-32.3247</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">0.8402</td>
<td style="text-align: right;">0.7732</td>
<td style="text-align: right;">-21.0841</td>
<td style="text-align: right;">-29.2293</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong>Best Models by Different Criteria:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">"leaps_results"</span>)) {</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a summary of best models</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  best_models_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Criterion =</span> <span class="fu">c</span>(<span class="st">"Highest R-squared"</span>, <span class="st">"Best Adjusted R-squared"</span>, <span class="st">"Best BIC"</span>),</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variables =</span> <span class="fu">c</span>(leaps_results<span class="sc">$</span>best_models<span class="sc">$</span>highest_rsq<span class="sc">$</span>n_variables,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>                  leaps_results<span class="sc">$</span>best_models<span class="sc">$</span>best_adj_rsq<span class="sc">$</span>n_variables,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>                  leaps_results<span class="sc">$</span>best_models<span class="sc">$</span>best_bic<span class="sc">$</span>n_variables),</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">R_squared =</span> <span class="fu">c</span>(leaps_results<span class="sc">$</span>best_models<span class="sc">$</span>highest_rsq<span class="sc">$</span>r_squared,</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>                  leaps_results<span class="sc">$</span>best_models<span class="sc">$</span>best_adj_rsq<span class="sc">$</span>r_squared,</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>                  leaps_results<span class="sc">$</span>best_models<span class="sc">$</span>best_bic<span class="sc">$</span>r_squared),</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Adj_R_squared =</span> <span class="fu">c</span>(leaps_results<span class="sc">$</span>best_models<span class="sc">$</span>highest_rsq<span class="sc">$</span>adj_r_squared,</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>                      leaps_results<span class="sc">$</span>best_models<span class="sc">$</span>best_adj_rsq<span class="sc">$</span>adj_r_squared,</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>                      leaps_results<span class="sc">$</span>best_models<span class="sc">$</span>best_bic<span class="sc">$</span>adj_r_squared),</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">BIC =</span> <span class="fu">c</span>(leaps_results<span class="sc">$</span>best_models<span class="sc">$</span>highest_rsq<span class="sc">$</span>bic,</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>            leaps_results<span class="sc">$</span>best_models<span class="sc">$</span>best_adj_rsq<span class="sc">$</span>bic,</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>            leaps_results<span class="sc">$</span>best_models<span class="sc">$</span>best_bic<span class="sc">$</span>bic)</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>  best_models_summary <span class="sc">%&gt;%</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">4</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Best Models by Different Criteria"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>)</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Best Models by Different Criteria</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Criterion</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Variables</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">R_squared</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Adj_R_squared</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Highest R-squared</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0.8402</td>
<td style="text-align: right;">0.7732</td>
<td style="text-align: right;">-29.2293</td>
</tr>
<tr class="even">
<td style="text-align: left;">Best Adjusted R-squared</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.8377</td>
<td style="text-align: right;">0.7768</td>
<td style="text-align: right;">-32.3247</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Best BIC</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.7655</td>
<td style="text-align: right;">0.7354</td>
<td style="text-align: right;">-42.4220</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong>Visualization of Top Models:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">"leaps_results"</span>)) {</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  plot_comparison <span class="ot">&lt;-</span> <span class="fu">plot_flight_model_comparison</span>(leaps_results<span class="sc">$</span>results, <span class="at">top_n =</span> <span class="dv">10</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(plot_comparison)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_quarto_3_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p><strong>Final Model Details:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">"best_model_rsq"</span>)) {</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a clean coefficient table</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  final_model_tidy <span class="ot">&lt;-</span> <span class="fu">tidy</span>(best_model_rsq) <span class="sc">%&gt;%</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">estimate =</span> <span class="fu">round</span>(estimate, <span class="dv">2</span>),</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">std.error =</span> <span class="fu">round</span>(std.error, <span class="dv">2</span>),</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">statistic =</span> <span class="fu">round</span>(statistic, <span class="dv">2</span>),</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">p.value =</span> <span class="fu">case_when</span>(</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>        p.value <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">"&lt; 0.001"</span>,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>        p.value <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, p.value),</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, p.value)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">significance =</span> <span class="fu">case_when</span>(</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.numeric</span>(<span class="fu">ifelse</span>(p.value <span class="sc">==</span> <span class="st">"&lt; 0.001"</span>, <span class="dv">0</span>, p.value)) <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">"***"</span>,</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.numeric</span>(<span class="fu">ifelse</span>(p.value <span class="sc">==</span> <span class="st">"&lt; 0.001"</span>, <span class="dv">0</span>, p.value)) <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"**"</span>,</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.numeric</span>(<span class="fu">ifelse</span>(p.value <span class="sc">==</span> <span class="st">"&lt; 0.001"</span>, <span class="dv">0</span>, p.value)) <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">"*"</span>,</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.numeric</span>(<span class="fu">ifelse</span>(p.value <span class="sc">==</span> <span class="st">"&lt; 0.001"</span>, <span class="dv">0</span>, p.value)) <span class="sc">&lt;</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="st">"."</span>,</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">""</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>  final_model_tidy <span class="sc">%&gt;%</span></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Final Model Coefficients"</span>,</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Term"</span>, <span class="st">"Estimate"</span>, <span class="st">"Std Error"</span>, <span class="st">"t-statistic"</span>, <span class="st">"p-value"</span>, <span class="st">"Sig."</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"400px"</span>)</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Model summary statistics</span></span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>  model_summary_stats <span class="ot">&lt;-</span> <span class="fu">glance</span>(best_model_rsq) <span class="sc">%&gt;%</span></span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(r.squared, adj.r.squared, sigma, statistic, p.value, df, nobs) <span class="sc">%&gt;%</span></span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">4</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Statistic"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>  model_summary_stats <span class="sc">%&gt;%</span></span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Final Model Summary Statistics"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a>                  <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>)</span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Final Model Summary Statistics</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">r.squared</td>
<td style="text-align: right;">0.8435</td>
</tr>
<tr class="even">
<td style="text-align: left;">adj.r.squared</td>
<td style="text-align: right;">0.7541</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sigma</td>
<td style="text-align: right;">1469.5468</td>
</tr>
<tr class="even">
<td style="text-align: left;">statistic</td>
<td style="text-align: right;">9.4314</td>
</tr>
<tr class="odd">
<td style="text-align: left;">p.value</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">df</td>
<td style="text-align: right;">16.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nobs</td>
<td style="text-align: right;">45.0000</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="key-findings" class="level2">
<h2 class="anchored" data-anchor-id="key-findings">Key Findings</h2>
<p><strong>Enhanced Model Performance:</strong> - The enhanced model with route parsing and airport codes provides more granular insights into flight pricing - Route-specific variables (airport codes for stops) show significant predictive power - The comprehensive approach combines traditional statistical methods with data science techniques</p>
<p><strong>Most Important Predictors:</strong></p>
<ol type="1">
<li><p><strong>Number of stops</strong> - Remains the strongest predictor</p></li>
<li><p><strong>Airport codes</strong> - Specific departure and arrival airports significantly impact pricing</p></li>
<li><p><strong>Duration of flight</strong> - Flight length is a key cost driver</p></li>
<li><p><strong>Airline</strong> - Different carriers have distinct pricing strategies</p></li>
<li><p><strong>Route complexity</strong> - The specific path taken affects pricing beyond just number of stops</p></li>
</ol>
<p><strong>Methodological Insights:</strong> - Random variable comparison helped identify which predictors truly add value - Standardized regression coefficients revealed the relative importance of continuous vs categorical variables - All subsets regression vs stepwise selection provided different perspectives on optimal model selection</p>
<p><strong>Business Insights:</strong> - Specific airport combinations create premium pricing opportunities - Route complexity beyond simple stop count influences pricing - Temporal factors (departure time, day, month) remain important but secondary to route characteristics - The enhanced model provides actionable insights for revenue optimization and pricing strategy</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>